var org;!function(t){var i,h;i=t.ssatguru||(t.ssatguru={}),function(t){var i,h,s=BABYLON.Axis,n=BABYLON.Color3,u=BABYLON.Matrix,r=BABYLON.Mesh,e=BABYLON.MeshBuilder,f=BABYLON.Path2,l=BABYLON.Quaternion,o=BABYLON.Space,a=BABYLON.StandardMaterial,c=BABYLON.Vector3;(h=i||(i={}))[h.TRANS=0]="TRANS",h[h.ROT=1]="ROT",h[h.SCALE=2]="SCALE";var M=function(){function t(t,i,h,s,n){var e=this;this.t=!0,this.i=!1,this.h=!1,this.s=1,this.u=Math.PI/18,this.l=.4,this.o=1,this.M=.02,this.v=.75,this.A=new u,this.L=new c(0,0,0),this.B=2,this.p=new c(0,0,0),this.N=new c(0,0,0),this.O="",this.C=!1,this.g=null,this.R=null,this.S=null,this.T=!1,this.k=!1,this.P=!1,this.j=0,this.q=0,this.D=0,this.F=!1,this.G=new c(0,0,0),this.H=new c(0,0,0),this.I=!1,this.J=new c(0,0,0),this.K=.25,this.U=new c(0,0,0),this.V=new c(0,0,0),this.W=new c(0,0,0),this.$=new c(0,0,0),this._=!1,this.tt=0,this.it=!1,this.ht=!1,this.st=!1,this.nt=180,this.ut=new c(this.s,this.s,this.s),this.rt=new c(0,0,0),this.et=new c(0,0,0),this.ft=new c(0,0,0),this.lt=new u,this.ot=t,this.at=i,this.ct=h,this.o=s,this._=null!==n&&n,this.Mt(),this.vt=t.getScene(),this.wt=new v(t,10),t.computeWorldMatrix(!0),this.Yt=this.Xt(t),this.Zt(t),this.At=new r("EditControl",this.vt),this.At.rotationQuaternion=l.Identity(),this.At.visibility=0,this.At.isPickable=!1,this.Lt(this.vt),this.Bt().parent=this.At,this.dt().parent=this.At,this.pt=function(t){return e.Nt(t)},this.Ot=function(t){return e.zt(t)},this.Et=function(t){return e.bt(t)},h.addEventListener("pointerdown",this.pt,!1),h.addEventListener("pointerup",this.Ot,!1),h.addEventListener("pointermove",this.Et,!1),this.xt=function(){return e.yt()},this.vt.registerBeforeRender(this.xt)}return t.prototype.Mt=function(){if(!this._&&(null==this.ot.rotationQuaternion||void 0==this.ot.rotationQuaternion))throw"Error: Eulerian is set to false but the mesh's rotationQuaternion is not set."},t.prototype.yt=function(){this.At.position=this.ot.getAbsolutePivotPoint(),this.Ct(),this.gt(),this.t?(this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L),this.Rt.lookAt(this.L,0,0,0,o.LOCAL)):(this.at.position.subtractToRef(this.At.position,this.L),this.Rt.lookAt(this.at.position,0,0,0,o.WORLD)),this.ht?this.St():this.it?this.Tt(this.kt,this.Pt,this.Qt):this.st&&this.Tt(this.jt,this.qt,this.Dt)},t.prototype.Ct=function(){if(this.t)if(null==this.ot.parent)if(this._){var t=this.ot.rotation;l.RotationYawPitchRollToRef(t.y,t.x,t.z,this.At.rotationQuaternion)}else this.At.rotationQuaternion.copyFrom(this.ot.rotationQuaternion);else this.ot.getWorldMatrix().getRotationMatrixToRef(this.lt),l.FromRotationMatrixToRef(this.lt,this.At.rotationQuaternion)},t.prototype.gt=function(){this.At.position.subtractToRef(this.at.position,this.p),c.FromFloatArrayToRef(this.at.getWorldMatrix().asArray(),8,this.N);var t=c.Dot(this.p,this.N)/this.N.length(),i=Math.abs(t/this.B);c.FromFloatsToRef(i,i,i,this.At.scaling)},t.prototype.St=function(){var t=Math.atan(this.L.y/this.L.z);this.L.z>=0?this.Ft.rotation.x=-t:this.Ft.rotation.x=-t-Math.PI;var i=Math.atan(this.L.x/this.L.z);this.L.z>=0?this.Gt.rotation.y=i:this.Gt.rotation.y=i+Math.PI;var h=Math.atan(this.L.x/this.L.y);this.L.y>=0?this.Ht.rotation.z=-h:this.Ht.rotation.z=-h-Math.PI},t.prototype.Tt=function(t,i,h){var s=this.L;t.rotation.x=0,t.rotation.y=0,t.rotation.z=0,i.rotation.x=0,i.rotation.y=0,i.rotation.z=0,h.rotation.x=0,h.rotation.y=0,h.rotation.z=0,s.x<=0&&s.y>=0&&s.z>=0?(t.rotation.z=3.14,h.rotation.y=3.14):s.x<=0&&s.y>=0&&s.z<=0?(t.rotation.y=3.14,i.rotation.y=3.14,h.rotation.y=3.14):s.x>=0&&s.y>=0&&s.z<=0?(t.rotation.x=3.14,i.rotation.y=3.14):s.x>=0&&s.y<=0&&s.z>=0?(i.rotation.z=3.14,h.rotation.x=3.14):s.x<=0&&s.y<=0&&s.z>=0?(t.rotation.z=3.14,i.rotation.z=3.14,h.rotation.z=3.14):s.x<=0&&s.y<=0&&s.z<=0?(t.rotation.y=3.14,i.rotation.x=3.14,h.rotation.z=3.14):s.x>=0&&s.y<=0&&s.z<=0&&(t.rotation.x=3.14,i.rotation.x=3.14,h.rotation.x=3.14)},t.prototype.switchTo=function(t,i){t.computeWorldMatrix(!0),this.ot=t,null!=i&&(this._=i),this.Mt(),this.Zt(t),this.wt=new v(t,10)},t.prototype.setUndoCount=function(t){this.wt.setCapacity(t)},t.prototype.undo=function(){var t=this.wt.undo();this.ot.computeWorldMatrix(!0),this.Zt(this.ot),this.It(t),this.Jt(t),this.Kt(t)},t.prototype.redo=function(){var t=this.wt.redo();this.ot.computeWorldMatrix(!0),this.Zt(this.ot),this.It(t),this.Jt(t),this.Kt(t)},t.prototype.detach=function(){this.ct.removeEventListener("pointerdown",this.pt,!1),this.ct.removeEventListener("pointerup",this.Ot,!1),this.ct.removeEventListener("pointermove",this.Et,!1),this.vt.unregisterBeforeRender(this.xt),this.removeAllActionListeners(),this.Ut()},t.prototype.hide=function(){this.C=!0,this.it?(this.O="T",this.disableTranslation()):this.ht?(this.O="R",this.disableRotation()):this.st&&(this.O="S",this.disableScaling()),this.Vt()},t.prototype.Vt=function(){this.Wt.visibility=0,this.$t.visibility=0,this._t.visibility=0},t.prototype.ti=function(){this.Wt.visibility=this.v,this.$t.visibility=this.v,this._t.visibility=this.v},t.prototype.show=function(){this.C=!1,this.ti(),"T"==this.O?this.enableTranslation():"R"==this.O?this.enableRotation():"S"==this.O&&this.enableScaling()},t.prototype.isHidden=function(){return this.C},t.prototype.Ut=function(){this.At.dispose(),this.ii(),this.wt=null},t.prototype.addActionListener=function(t){this.g=t},t.prototype.removeActionListener=function(){this.g=null},t.prototype.addActionStartListener=function(t){this.R=t},t.prototype.removeActionStartListener=function(){this.R=null},t.prototype.addActionEndListener=function(t){this.S=t},t.prototype.removeActionEndListener=function(){this.S=null},t.prototype.removeAllActionListeners=function(){this.g=null,this.R=null,this.S=null},t.prototype.Nt=function(t){var i=this;if(t.preventDefault(),this.T=!0,0==t.button){var h=this.vt.pick(this.vt.pointerX,this.vt.pointerY,function(t){if(i.it){if(t==i.hi||t==i.si||t==i.ni||t==i.kt||t==i.Pt||t==i.Qt||t==i.ui)return!0}else if(i.ht){if(t==i.Ft||t==i.Gt||t==i.Ht||t==i.ri)return!0}else if(i.st&&(t==i.ei||t==i.fi||t==i.li||t==i.jt||t==i.qt||t==i.Dt||t==i.oi))return!0;return!1},null,this.at);if(h.hit){this.ai=h.pickedMesh;var s=this.ai.getChildren();s.length>0?s[0].visibility=this.v:this.ai.visibility=this.v;var n=this.ai.name;"X"==n?this.ci.visibility=1:"Y"==n?this.Mi.visibility=1:"Z"==n?this.vi.visibility=1:"XZ"==n?(this.ci.visibility=1,this.vi.visibility=1):"ZY"==n?(this.vi.visibility=1,this.Mi.visibility=1):"YX"==n?(this.Mi.visibility=1,this.ci.visibility=1):"ALL"==n&&(this.ci.visibility=1,this.Mi.visibility=1,this.vi.visibility=1),this.wi(!0),this.Yi=this.Xi(this.ai),null!=this.Yi?this.Zi=this.Ai():this.Zi=null,window.setTimeout(function(t,h){return i.Li(t,h)},0,this.at,this.ct)}}},t.prototype.wi=function(t){this.P=t,t?(this.Bi(),this.It(this.di)):this.Kt(this.di)},t.prototype.isEditing=function(){return this.P},t.prototype.Li=function(t,i){var h=i;t.detachControl(h)},t.prototype.isPointerOver=function(){return this.k},t.prototype.pi=function(){var t=this,i=this.vt.pick(this.vt.pointerX,this.vt.pointerY,function(i){if(t.it){if(i==t.hi||i==t.si||i==t.ni||i==t.kt||i==t.Pt||i==t.Qt||i==t.ui)return!0}else if(t.ht){if(i==t.Ft||i==t.Gt||i==t.Ht||i==t.ri)return!0}else if(t.st&&(i==t.ei||i==t.fi||i==t.li||i==t.jt||i==t.qt||i==t.Dt||i==t.oi))return!0;return!1},null,this.at);if(i.hit){if(i.pickedMesh!=this.Ni){if(this.k=!0,this.Oi(),this.Ni=i.pickedMesh,this.ht)this.zi=this.Ni.getChildren()[0].color,this.Ni.getChildren()[0].color=n.White();else{var h=this.Ni.getChildren();h.length>0?(this.Ei=h[0].material,h[0].material=this.bi):(this.Ei=this.Ni.material,this.Ni.material=this.bi)}"X"==this.Ni.name?this.Wt.color=n.White():"Y"==this.Ni.name?this.$t.color=n.White():"Z"==this.Ni.name&&(this._t.color=n.White())}}else this.k=!1,null!=this.Ni&&(this.xi(this.Ni),this.Ni=null)},t.prototype.Oi=function(){null!=this.Ni&&(this.Ni.visibility=0,this.xi(this.Ni))},t.prototype.xi=function(t){switch(t.name){case"X":this.Wt.color=n.Red();break;case"Y":this.$t.color=n.Green();break;case"Z":this._t.color=n.Blue()}if(this.ht)t.getChildren()[0].color=this.zi;else{var i=t.getChildren();i.length>0?i[0].material=this.Ei:t.material=this.Ei}},t.prototype.zt=function(t){this.T=!1,this.P&&(this.at.attachControl(this.ct),this.wi(!1),this.yi(),null!=this.Ni&&(this.xi(this.Ni),this.Ni=null),this.wt.add(this.di))},t.prototype.Bi=function(){this.it?this.di=i.TRANS:this.ht?this.di=i.ROT:this.st&&(this.di=i.SCALE)},t.prototype.Jt=function(t){null!=this.g&&this.g(t)},t.prototype.It=function(t){null!=this.R&&this.R(t)},t.prototype.Kt=function(t){null!=this.S&&this.S(t)},t.prototype.bt=function(t){if(this.T){if(this.P&&null!=this.Zi&&(null==this.ot.parent||!this.t||this.ot.parent.scaling.x==this.ot.parent.scaling.y&&this.ot.parent.scaling.y==this.ot.parent.scaling.z)){var i=this.Ai();if(null!=i){if(this.ht)this.Ci(this.ot,this.ai,i,this.Zi);else{var h=i.subtract(this.Zi);if(0==h.x&&0==h.y&&0==h.z)return;this.it?this.gi(h):this.st&&this.t&&this.mi(h)}this.Zi=i,this.Jt(this.di)}}}else this.pi()},t.prototype.Xi=function(t){var i=t.name;if(this.it||this.st){if("XZ"==i)return this.Ri;if("ZY"==i)return this.Si;if("YX"==i)return this.Ti;if("ALL"==i)return this.Rt;this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L);var h=this.L;if("X"===i)return Math.abs(h.y)>Math.abs(h.z)?this.Ri:this.Ti;if("Z"===i)return Math.abs(h.y)>Math.abs(h.x)?this.Ri:this.Si;if("Y"===i)return Math.abs(h.z)>Math.abs(h.x)?this.Ti:this.Si}else{if(!this.ht)return null;switch(this.F=!1,this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L),h=this.L,i){case"X":return Math.abs(h.x)<.2?(this.F=!0,this.Rt):this.Si;case"Y":return Math.abs(h.y)<.2?(this.F=!0,this.Rt):this.Ri;case"Z":return Math.abs(h.z)<.2?(this.F=!0,this.Rt):this.Ti;default:return this.Rt}}},t.prototype.gi=function(t){this.Zt(this.ot);var i=this.ai.name;"ALL"==i?this.G=t:(this.G.x=0,this.G.y=0,this.G.z=0,"X"!=i&&"XZ"!=i&&"YX"!=i||(this.t?this.G.x=c.Dot(t,this.V)/this.V.length():this.G.x=t.x),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.t?this.G.y=c.Dot(t,this.W)/this.W.length():this.G.y=t.y),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.t?this.G.z=c.Dot(t,this.$)/this.$.length():this.G.z=t.z)),this.ki(this.ot,this.G,this.t),this.Pi&&(this.ot.position.x=Math.max(this.ot.position.x,this.Pi.x),this.ot.position.y=Math.max(this.ot.position.y,this.Pi.y),this.ot.position.z=Math.max(this.ot.position.z,this.Pi.z)),this.Qi&&(this.ot.position.x=Math.min(this.ot.position.x,this.Qi.x),this.ot.position.y=Math.min(this.ot.position.y,this.Qi.y),this.ot.position.z=Math.min(this.ot.position.z,this.Qi.z)),this.ot.computeWorldMatrix(!0)},t.prototype.ki=function(t,i,h){if(this.i){var s=!1;if(this.H.addInPlace(i),Math.abs(this.H.x)>this.ut.x&&(this.H.x>0?i.x=this.ut.x:i.x=-this.ut.x,s=!0),Math.abs(this.H.y)>this.ut.y&&(this.H.y>0?i.y=this.ut.y:i.y=-this.ut.y,s=!0),Math.abs(this.H.z)>this.ut.z&&(this.H.z>0?i.z=this.ut.z:i.z=-this.ut.z,s=!0),!s)return;Math.abs(i.x)!==this.ut.x&&(i.x=0),Math.abs(i.y)!==this.ut.y&&(i.y=0),Math.abs(i.z)!==this.ut.z&&(i.z=0),c.FromFloatsToRef(0,0,0,this.H),s=!1}h?(this.V.normalizeToRef(this.rt),this.W.normalizeToRef(this.et),this.$.normalizeToRef(this.ft),this.ot.translate(this.rt,i.x,o.WORLD),this.ot.translate(this.et,i.y,o.WORLD),this.ot.translate(this.ft,i.z,o.WORLD)):null==this.ot.parent?this.ot.position.addInPlace(i):this.ot.setAbsolutePosition(i.addInPlace(this.ot.absolutePosition))},t.prototype.mi=function(t){this.Zt(this.ot),this.U.x=0,this.U.y=0,this.U.z=0;var i=this.ai.name;"X"!=i&&"XZ"!=i&&"YX"!=i||(this.U.x=c.Dot(t,this.V)/this.V.length(),this.ot.scaling.x<0&&(this.U.x=-this.U.x)),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.U.y=c.Dot(t,this.W)/this.W.length(),this.ot.scaling.y<0&&(this.U.y=-this.U.y)),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.U.z=c.Dot(t,this.$)/this.$.length(),this.ot.scaling.z<0&&(this.U.z=-this.U.z));var h=this.Yt;if(this.U.x=this.U.x/h.x,this.U.y=this.U.y/h.y,this.U.z=this.U.z/h.z,"ALL"==i){var s=c.Dot(t,this.at.upVector);s/=Math.max(h.x,h.y,h.z),this.U.copyFromFloats(s,s,s)}else{var n=!1;"XZ"==i?(n=!0,Math.abs(this.U.x)>Math.abs(this.U.z)?this.U.z=this.U.x:this.U.x=this.U.z):"ZY"==i?(n=!0,Math.abs(this.U.z)>Math.abs(this.U.y)?this.U.y=this.U.z:this.U.z=this.U.y):"YX"==i&&(n=!0,Math.abs(this.U.y)>Math.abs(this.U.x)?this.U.x=this.U.y:this.U.y=this.U.x),n&&(this.At.position.subtractToRef(this.at.position,this.p),s=c.Dot(t,this.p),this.U.x=Math.abs(this.U.x),this.U.y=Math.abs(this.U.y),this.U.z=Math.abs(this.U.z),s>0?(this.ot.scaling.x>0&&(this.U.x=-this.U.x),this.ot.scaling.y>0&&(this.U.y=-this.U.y),this.ot.scaling.z>0&&(this.U.z=-this.U.z)):(this.ot.scaling.x<0&&(this.U.x=-this.U.x),this.ot.scaling.y<0&&(this.U.y=-this.U.y),this.ot.scaling.z<0&&(this.U.z=-this.U.z)))}this.ji(this.ot,this.U),this.qi&&(this.ot.scaling.x=Math.max(this.ot.scaling.x,this.qi.x),this.ot.scaling.y=Math.max(this.ot.scaling.y,this.qi.y),this.ot.scaling.z=Math.max(this.ot.scaling.z,this.qi.z)),this.Di&&(this.ot.scaling.x=Math.min(this.ot.scaling.x,this.Di.x),this.ot.scaling.y=Math.min(this.ot.scaling.y,this.Di.y),this.ot.scaling.z=Math.min(this.ot.scaling.z,this.Di.z))},t.prototype.ji=function(t,i){if(this.I){var h=!1;if(this.J.addInPlace(i),Math.abs(this.J.x)>this.K&&(i.x>0?i.x=this.K:i.x=-this.K,h=!0),Math.abs(this.J.y)>this.K&&(i.y>0?i.y=this.K:i.y=-this.K,h=!0),Math.abs(this.J.z)>this.K&&(i.z>0?i.z=this.K:i.z=-this.K,h=!0),!h)return;Math.abs(i.x)!==this.K&&0!==i.x&&(i.x=0),Math.abs(i.y)!==this.K&&0!==i.y&&(i.y=0),Math.abs(i.z)!==this.K&&0!==i.z&&(i.z=0),c.FromFloatsToRef(0,0,0,this.J),h=!1}t.scaling.addInPlace(i)},t.prototype.Zt=function(t){var i=t.getWorldMatrix();c.FromFloatArrayToRef(i.m,0,this.V),c.FromFloatArrayToRef(i.m,4,this.W),c.FromFloatArrayToRef(i.m,8,this.$)},t.prototype.Xt=function(t){var i=t.getBoundingInfo().boundingBox,h=i.maximum.subtract(i.minimum);return 0==h.x&&(h.x=1),0==h.y&&(h.y=1),0==h.z&&(h.z=1),h},t.prototype.refreshBoundingInfo=function(){this.Yt=this.Xt(this.ot)},t.prototype.Ci=function(t,i,h,n){this.Zt(this.ot);var u,r=0;i==this.Ft?u=this.t?this.V:s.X:i==this.Gt?u=this.t?this.W:s.Y:i==this.Ht&&(u=this.t?this.$:s.Z),this.At.position.subtractToRef(this.at.position,this.p),this.F?(r=this.Fi(n,h,this.at.position,this.p,u),this.vt.useRightHandedSystem&&(r=-r)):r=this.Gi(n,h,t.getAbsolutePivotPoint(),this.p),this.p.normalize(),i==this.Ft?(this.h&&(this.j+=r,r=0,Math.abs(this.j)>=this.u&&(r=this.j>0?this.u:-this.u,this.j=0)),0!==r&&(c.Dot(u,this.p)>=0&&(r*=-1),t.rotate(u,r,o.WORLD))):i==this.Gt?(this.h&&(this.q+=r,r=0,Math.abs(this.q)>=this.u&&(r=this.q>0?this.u:-this.u,this.q=0)),0!==r&&0!==r&&(c.Dot(u,this.p)>=0&&(r*=-1),t.rotate(u,r,o.WORLD))):i==this.Ht?(this.h&&(this.D+=r,r=0,Math.abs(this.D)>=this.u&&(r=this.D>0?this.u:-this.u,this.D=0)),0!==r&&0!==r&&(c.Dot(u,this.p)>=0&&(r*=-1),t.rotate(u,r,o.WORLD))):i==this.ri&&(this.h&&(this.tt+=r,r=0,Math.abs(this.tt)>=this.u&&(r=this.tt>0?this.u:-this.u,this.tt=0)),0!==r&&t.rotate(this.p,-r,o.WORLD)),this._&&0!=r&&(t.rotation=t.rotationQuaternion.toEulerAngles(),t.rotationQuaternion=null)},t.prototype.Ai=function(){var t=this,i=this.vt.pick(this.vt.pointerX,this.vt.pointerY,function(i){return i==t.Yi},null,this.at);return i.hit?i.pickedPoint:null},t.prototype.yi=function(){this.ci.visibility=0,this.Mi.visibility=0,this.vi.visibility=0},t.prototype.Hi=function(t){this.it&&(this.Ii.visibility=t,this.Ji.visibility=t,this.Ki.visibility=t,this.Ui.visibility=t,this.Vi.visibility=t,this.Wi.visibility=t,this.$i.visibility=t),this.ht&&(this._i.visibility=t,this.th.visibility=t,this.ih.visibility=t,this.hh.visibility=t),this.st&&(this.sh.visibility=t,this.nh.visibility=t,this.uh.visibility=t,this.rh.visibility=t,this.eh.visibility=t,this.fh.visibility=t,this.lh.visibility=t)},t.prototype.getRotationQuaternion=function(){return this.At.rotationQuaternion},t.prototype.getPosition=function(){return this.At.position},t.prototype.isTranslationEnabled=function(){return this.it},t.prototype.enableTranslation=function(){null==this.hi&&(this.oh(),this.ah.parent=this.At),this.Oi(),this.it||(this.Ii.visibility=this.v,this.Ji.visibility=this.v,this.Ki.visibility=this.v,this.Ui.visibility=this.v,this.Vi.visibility=this.v,this.Wi.visibility=this.v,this.$i.visibility=this.v,this.it=!0,this.disableRotation(),this.disableScaling())},t.prototype.disableTranslation=function(){this.it&&(this.Ii.visibility=0,this.Ji.visibility=0,this.Ki.visibility=0,this.Ui.visibility=0,this.Vi.visibility=0,this.Wi.visibility=0,this.$i.visibility=0,this.it=!1)},t.prototype.isRotationEnabled=function(){return this.ht},t.prototype.returnEuler=function(t){this._=t},t.prototype.enableRotation=function(){null==this.Mh&&(this.vh(),this.Mh.parent=this.At),this.Oi(),this.ht||(this._i.visibility=this.v,this.th.visibility=this.v,this.ih.visibility=this.v,this.hh.visibility=this.v,this.wh.visibility=this.v,this.ht=!0,this.disableTranslation(),this.disableScaling())},t.prototype.disableRotation=function(){this.ht&&(this._i.visibility=0,this.th.visibility=0,this.ih.visibility=0,this.hh.visibility=0,this.wh.visibility=0,this.ht=!1)},t.prototype.isScalingEnabled=function(){return this.st},t.prototype.enableScaling=function(){null==this.ei&&(this.Yh(),this.Xh.parent=this.At),this.Oi(),this.st||(this.sh.visibility=this.v,this.nh.visibility=this.v,this.uh.visibility=this.v,this.rh.visibility=this.v,this.eh.visibility=this.v,this.fh.visibility=this.v,this.lh.visibility=this.v,this.st=!0,this.disableTranslation(),this.disableRotation())},t.prototype.disableScaling=function(){this.st&&(this.sh.visibility=0,this.nh.visibility=0,this.uh.visibility=0,this.rh.visibility=0,this.eh.visibility=0,this.fh.visibility=0,this.lh.visibility=0,this.st=!1)},t.prototype.setScaleBounds=function(t,i){this.qi=t||null,this.Di=i||null,null!=this.qi&&(0==this.qi.x&&(this.qi.x=1e-8),0==this.qi.y&&(this.qi.y=1e-8),0==this.qi.z&&(this.qi.z=1e-8))},t.prototype.removeScaleBounds=function(){this.qi=null,this.Di=null},t.prototype.setTransBounds=function(t,i){this.Pi=t||null,this.Qi=i||null},t.prototype.removeTransBounds=function(){this.Pi=null,this.Qi=null},t.prototype.setRotBounds=function(t,i){this.Zh=t||null,this.Ah=i||null},t.prototype.removeRotBounds=function(){this.Zh=null,this.Ah=null},t.prototype.Bt=function(){var t=new r("guideCtl",this.vt);this.ci=r.CreateLines("bxAxis",[new c(-100,0,0),new c(100,0,0)],this.vt),this.Mi=r.CreateLines("byAxis",[new c(0,-100,0),new c(0,100,0)],this.vt),this.vi=r.CreateLines("bzAxis",[new c(0,0,-100),new c(0,0,100)],this.vt),this.ci.isPickable=!1,this.Mi.isPickable=!1,this.vi.isPickable=!1,this.ci.parent=t,this.Mi.parent=t,this.vi.parent=t,this.ci.color=n.Red(),this.Mi.color=n.Green(),this.vi.color=n.Blue(),this.yi();var i=this.l*this.o*.75;return this.Wt=r.CreateLines("xAxis",[new c(0,0,0),new c(i,0,0)],this.vt),this.$t=r.CreateLines("yAxis",[new c(0,0,0),new c(0,i,0)],this.vt),this._t=r.CreateLines("zAxis",[new c(0,0,0),new c(0,0,i)],this.vt),this.Wt.isPickable=!1,this.$t.isPickable=!1,this._t.isPickable=!1,this.Wt.parent=t,this.$t.parent=t,this._t.parent=t,this.Wt.color=n.Red(),this.$t.color=n.Green(),this._t.color=n.Blue(),this.Wt.renderingGroupId=1,this.$t.renderingGroupId=1,this._t.renderingGroupId=1,t},t.prototype.dt=function(){this.Rt=r.CreatePlane("pALL",5,this.vt),this.Ri=r.CreatePlane("pXZ",5,this.vt),this.Si=r.CreatePlane("pZY",5,this.vt),this.Ti=r.CreatePlane("pYX",5,this.vt),this.Rt.isPickable=!1,this.Ri.isPickable=!1,this.Si.isPickable=!1,this.Ti.isPickable=!1,this.Rt.visibility=0,this.Ri.visibility=0,this.Si.visibility=0,this.Ti.visibility=0,this.Rt.renderingGroupId=1,this.Ri.renderingGroupId=1,this.Si.renderingGroupId=1,this.Ti.renderingGroupId=1,this.Rt.lookAt(this.at.position),this.Ri.rotate(s.X,1.57),this.Si.rotate(s.Y,1.57);var t=new r("pickPlanes",this.vt);return this.Rt.parent=t,this.Ri.parent=t,this.Si.parent=t,this.Ti.parent=t,t},t.prototype.oh=function(){var t=2*this.M*this.o,i=this.l*this.o;this.ah=new r("tarnsCtl",this.vt),this.hi=this.Lh(t/2,i),this.hi.name="X",this.si=this.hi.clone("Y"),this.ni=this.hi.clone("Z"),this.kt=e.CreatePlane("XZ",{size:2*t},this.vt),this.Pt=e.CreatePlane("ZY",{size:2*t},this.vt),this.Qt=e.CreatePlane("YX",{size:2*t},this.vt),this.kt.rotation.x=1.57,this.Pt.rotation.y=-1.57,this.kt.position.x=t,this.kt.position.z=t,this.Pt.position.z=t,this.Pt.position.y=t,this.Qt.position.y=t,this.Qt.position.x=t,this.kt.bakeCurrentTransformIntoVertices(),this.Pt.bakeCurrentTransformIntoVertices(),this.Qt.bakeCurrentTransformIntoVertices(),this.ui=r.CreateBox("ALL",2*t,this.vt),this.hi.parent=this.ah,this.si.parent=this.ah,this.ni.parent=this.ah,this.kt.parent=this.ah,this.Pt.parent=this.ah,this.Qt.parent=this.ah,this.ui.parent=this.ah,this.hi.rotation.y=1.57,this.si.rotation.x-=1.57,this.hi.visibility=0,this.si.visibility=0,this.ni.visibility=0,this.kt.visibility=0,this.Pt.visibility=0,this.Qt.visibility=0,this.ui.visibility=0,this.hi.isPickable=!1,this.si.isPickable=!1,this.ni.isPickable=!1,this.kt.isPickable=!1,this.Pt.isPickable=!1,this.Qt.isPickable=!1,this.ui.isPickable=!1;var h=i/5,s=t;this.Ii=r.CreateCylinder("tEndX",h,0,s,6,1,this.vt),this.Ji=this.Ii.clone("tEndY"),this.Ki=this.Ii.clone("tEndZ"),this.Ui=this.Bh("XZ",1.75*s,this.vt),this.Vi=this.Ui.clone("ZY"),this.Wi=this.Ui.clone("YX"),this.$i=e.CreatePolyhedron("tEndAll",{type:1,size:s/2},this.vt),this.Ii.rotation.x=1.57,this.Ji.rotation.x=1.57,this.Ki.rotation.x=1.57,this.Vi.rotation.z=1.57,this.Wi.rotation.x=-1.57,this.Ui.position.x=t,this.Ui.position.z=t,this.Vi.position.z=t,this.Vi.position.y=t,this.Wi.position.y=t,this.Wi.position.x=t,this.Ii.parent=this.hi,this.Ji.parent=this.si,this.Ki.parent=this.ni,this.Ui.parent=this.kt,this.Vi.parent=this.Pt,this.Wi.parent=this.Qt,this.$i.parent=this.ui,this.Ii.position.z=i-h/2,this.Ji.position.z=i-h/2,this.Ki.position.z=i-h/2,this.Ii.material=this.dh,this.Ji.material=this.ph,this.Ki.material=this.Nh,this.Ui.material=this.ph,this.Vi.material=this.dh,this.Wi.material=this.Nh,this.$i.material=this.Oh,this.Ii.renderingGroupId=2,this.Ji.renderingGroupId=2,this.Ki.renderingGroupId=2,this.Ui.renderingGroupId=2,this.Vi.renderingGroupId=2,this.Wi.renderingGroupId=2,this.$i.renderingGroupId=2,this.Ii.isPickable=!1,this.Ji.isPickable=!1,this.Ki.isPickable=!1,this.Ui.isPickable=!1,this.Vi.isPickable=!1,this.Wi.isPickable=!1,this.$i.isPickable=!1},t.prototype.Bh=function(t,i,h){var s=new f(i/2,-i/2).addLineTo(i/2,i/2).addLineTo(-i/2,i/2).addLineTo(i/2,-i/2);return new BABYLON.PolygonMeshBuilder(t,s,h).build()},t.prototype.setRotGuideFull=function(t){this.nt=t?360:180,null!=this.Mh&&(this.Mh.dispose(),this.ri.dispose(),this.Mh=null,this.enableRotation())},t.prototype.vh=function(){var t=this.l*this.o*2;this.Mh=new r("rotCtl",this.vt),this.Ft=this.zh(t/2,this.nt),this.Ft.name="X",this.Gt=this.zh(t/2,this.nt),this.Gt.name="Y",this.Ht=this.zh(t/2,this.nt),this.Ht.name="Z",this.ri=this.zh(t/1.75,360),this.ri.name="ALL",this.Ft.rotation.z=1.57,this.Ht.rotation.x=-1.57,this.Ft.bakeCurrentTransformIntoVertices(),this.Ht.bakeCurrentTransformIntoVertices(),this.ri.rotation.x=1.57,this.Ft.parent=this.Mh,this.Gt.parent=this.Mh,this.Ht.parent=this.Mh,this.ri.parent=this.Rt,this.Ft.visibility=0,this.Gt.visibility=0,this.Ht.visibility=0,this.ri.visibility=0,this.Ft.isPickable=!1,this.Gt.isPickable=!1,this.Ht.isPickable=!1,this.ri.isPickable=!1;var i=t;this._i=this.Eh(i/2,this.nt,!1),this.th=this._i.clone(""),this.ih=this._i.clone(""),this.hh=this.Eh(i/1.75,360,!1),this.wh=this.Eh(i/2,360,!1),this._i.parent=this.Ft,this.th.parent=this.Gt,this.ih.parent=this.Ht,this._i.rotation.z=1.57,this.ih.rotation.x=-1.57,this.hh.parent=this.ri,this.wh.parent=this.ri,this._i.color=n.Red(),this.th.color=n.Green(),this.ih.color=n.Blue(),this.hh.color=n.Yellow(),this.wh.color=n.Gray(),this._i.renderingGroupId=2,this.th.renderingGroupId=2,this.ih.renderingGroupId=2,this.hh.renderingGroupId=2,this.wh.renderingGroupId=2,this._i.isPickable=!1,this.th.isPickable=!1,this.ih.isPickable=!1,this.hh.isPickable=!1},t.prototype.Lh=function(t,i){var h=[new c(t,t,0),new c(-t,t,0),new c(-t,-t,0),new c(t,-t,0),new c(t,t,0)],s=[new c(0,0,0),new c(0,0,i)];return r.ExtrudeShape("",h,s,1,0,2,this.vt)},t.prototype.Eh=function(t,i,h){null===i&&(i=360);for(var s,n,u=[],e=3.14/180,f=0,l=0;l<=i;l+=5)s=t*Math.cos(l*e),n=90==l?t:270==l?-t:t*Math.sin(l*e),u[f]=new c(s,0,n),f++;if(h)for(t-=.04,l=0;l<=i;l+=5)s=t*Math.cos(l*e),n=90==l?t:270==l?-t:t*Math.sin(l*e),u[f]=new c(s,0,n),f++;return r.CreateLines("",u,this.vt)},t.prototype.zh=function(t,i){null===i&&(i=360);for(var h,s,n=[],u=0,e=0;e<=i;e+=30)h=t*Math.cos(e*(3.14/180)),s=90==e?t:270==e?-t:t*Math.sin(e*(3.14/180)),n[u]=new c(h,0,s),u++;return r.CreateTube("",n,this.M*this.o*2,3,null,BABYLON.Mesh.bh,this.vt)},t.prototype.Yh=function(){var t=2*this.M*this.o,i=this.l*this.o;this.Xh=new r("sCtl",this.vt),this.ei=this.Lh(t/2,i),this.ei.name="X",this.fi=this.ei.clone("Y"),this.li=this.ei.clone("Z"),this.jt=e.CreatePlane("XZ",{size:2*t},this.vt),this.qt=e.CreatePlane("ZY",{size:2*t},this.vt),this.Dt=e.CreatePlane("YX",{size:2*t},this.vt),this.jt.rotation.x=1.57,this.qt.rotation.y=-1.57,this.jt.position.x=t,this.jt.position.z=t,this.qt.position.z=t,this.qt.position.y=t,this.Dt.position.y=t,this.Dt.position.x=t,this.jt.bakeCurrentTransformIntoVertices(),this.qt.bakeCurrentTransformIntoVertices(),this.Dt.bakeCurrentTransformIntoVertices(),this.oi=r.CreateBox("ALL",2*t,this.vt),this.ei.parent=this.Xh,this.fi.parent=this.Xh,this.li.parent=this.Xh,this.oi.parent=this.Xh,this.jt.parent=this.Xh,this.qt.parent=this.Xh,this.Dt.parent=this.Xh,this.ei.rotation.y=1.57,this.fi.rotation.x-=1.57,this.ei.visibility=0,this.fi.visibility=0,this.li.visibility=0,this.jt.visibility=0,this.qt.visibility=0,this.Dt.visibility=0,this.oi.visibility=0,this.ei.isPickable=!1,this.fi.isPickable=!1,this.li.isPickable=!1,this.jt.isPickable=!1,this.qt.isPickable=!1,this.Dt.isPickable=!1,this.oi.isPickable=!1;var h=t;this.sh=r.CreateBox("",h,this.vt),this.nh=this.sh.clone(""),this.uh=this.sh.clone(""),this.rh=this.Bh("XZ",1.75*h,this.vt),this.eh=this.rh.clone("ZY"),this.fh=this.rh.clone("YX"),this.lh=e.CreatePolyhedron("sEndAll",{type:1,size:h/2},this.vt),this.eh.rotation.z=1.57,this.fh.rotation.x=-1.57,this.rh.position.x=t,this.rh.position.z=t,this.eh.position.z=t,this.eh.position.y=t,this.fh.position.y=t,this.fh.position.x=t,this.sh.parent=this.ei,this.nh.parent=this.fi,this.uh.parent=this.li,this.rh.parent=this.jt,this.eh.parent=this.qt,this.fh.parent=this.Dt,this.lh.parent=this.oi,this.sh.position.z=i-h/2,this.nh.position.z=i-h/2,this.uh.position.z=i-h/2,this.sh.material=this.dh,this.nh.material=this.ph,this.uh.material=this.Nh,this.rh.material=this.ph,this.eh.material=this.dh,this.fh.material=this.Nh,this.lh.material=this.Oh,this.sh.renderingGroupId=2,this.nh.renderingGroupId=2,this.uh.renderingGroupId=2,this.rh.renderingGroupId=2,this.eh.renderingGroupId=2,this.fh.renderingGroupId=2,this.lh.renderingGroupId=2,this.sh.isPickable=!1,this.nh.isPickable=!1,this.uh.isPickable=!1,this.rh.isPickable=!1,this.eh.isPickable=!1,this.fh.isPickable=!1,this.lh.isPickable=!1},t.prototype.xh=function(t){var i=c.Cross(this.V,this.W);return c.Dot(i,this.$)<0},t.prototype.setVisibility=function(t){this.v=t},t.prototype.setLocal=function(t){this.t!=t&&(this.t=t,t||(this.At.rotationQuaternion=l.Identity()))},t.prototype.isLocal=function(){return this.t},t.prototype.setTransSnap=function(t){this.i=t},t.prototype.setRotSnap=function(t){this.h=t},t.prototype.setScaleSnap=function(t){this.I=t},t.prototype.setTransSnapValue=function(t){this.ut.copyFromFloats(t,t,t),this.s=t},t.prototype.setRotSnapValue=function(t){this.u=t},t.prototype.setScaleSnapValue=function(t){this.K=t},t.prototype.Fi=function(t,i,h,s,n){var u=c.Dot(s,n);n.scaleToRef(u,this.rt),h.addToRef(this.rt,this.et);var r=this.et;this.at.getWorldMatrix().invertToRef(this.lt),c.TransformCoordinatesToRef(this.et,this.lt,this.et);var e=0;r.x>=0&&r.y>=0?e=1:r.x<=0&&r.y>=0?e=2:r.x<=0&&r.y<=0?e=3:r.x>=0&&r.y<=0&&(e=4),c.TransformCoordinatesToRef(t,this.lt,this.rt),c.TransformCoordinatesToRef(i,this.lt,this.et),this.et.subtractInPlace(this.rt);var f=this.et,l=f.length(),o="";f.x>=0&&f.y>=0?o=f.x>=f.y?"r":"u":f.x<=0&&f.y>=0?o=-f.x>=f.y?"l":"u":f.x<=0&&f.y<=0?o=-f.x>=-f.y?"l":"d":f.x>=0&&f.y<=0&&(o=f.x>=-f.y?"r":"d");var a=0;return"d"==o?a=1==e||4==e?1:-1:"u"==o?a=1==e||4==e?-1:1:"r"==o?a=2==e||1==e?1:-1:"l"==o&&(a=2==e||1==e?-1:1),a*l},t.prototype.Gi=function(t,i,h,s){t.subtractToRef(h,this.rt),i.subtractToRef(h,this.et),c.CrossToRef(this.rt,this.et,this.ft);var n=Math.asin(this.ft.length()/(this.rt.length()*this.et.length()));return c.Dot(this.ft,s)>0&&(n*=-1),n},t.prototype.Lt=function(i){this.dh=t.yh("redMat",n.Red(),i),this.ph=t.yh("greenMat",n.Green(),i),this.Nh=t.yh("blueMat",n.Blue(),i),this.bi=t.yh("whiteMat",n.White(),i),this.Oh=t.yh("whiteMat",n.Yellow(),i)},t.prototype.ii=function(){this.dh.dispose(),this.ph.dispose(),this.Nh.dispose(),this.bi.dispose(),this.Oh.dispose()},t.yh=function(t,i,h){var s=new a(t,h);return s.emissiveColor=i,s.diffuseColor=n.Black(),s.specularColor=n.Black(),s.backFaceCulling=!1,s},t}();t.EditControl=M;var v=function(){function t(t,i){this.lastMax=10,this.acts=new Array,this.last=-1,this.current=-1,this.mesh=t,this.lastMax=i-1,this.add()}return t.prototype.setCapacity=function(t){0!=t?(this.lastMax=t-1,this.last=-1,this.current=-1,this.acts=new Array,this.add()):console.error("capacity should be more than zero")},t.prototype.add=function(t){void 0===t&&(t=null);var i=new w(this.mesh,t);this.current<this.last&&(this.acts.splice(this.current+1),this.last=this.current),this.last==this.lastMax?(this.acts.shift(),this.acts.push(i)):(this.acts.push(i),this.last++,this.current++)},t.prototype.undo=function(){if(this.current>0){var t=this.acts[this.current].getActionType();return this.current--,this.acts[this.current].perform(this.mesh),t}},t.prototype.redo=function(){if(this.current<this.last)return this.current++,this.acts[this.current].perform(this.mesh),this.acts[this.current].getActionType()},t}();t.ActHist=v;var w=function(){function t(t,i){this.Ch=t.position.clone(),null==t.rotationQuaternion?(this.gh=null,this.mh=t.rotation.clone()):(this.gh=t.rotationQuaternion.clone(),this.mh=null),this.Rh=t.scaling.clone(),this.Sh=i}return t.prototype.getActionType=function(){return this.Sh},t.prototype.perform=function(t){t.position.copyFrom(this.Ch),null==t.rotationQuaternion?null!=this.mh?t.rotation.copyFrom(this.mh):t.rotation.copyFrom(this.gh.toEulerAngles()):null!=this.gh?t.rotationQuaternion.copyFrom(this.gh):t.rotationQuaternion.copyFrom(l.RotationYawPitchRoll(this.mh.y,this.mh.x,this.mh.z)),t.scaling.copyFrom(this.Rh)},t}();t.Act=w}((h=i.babylonjs||(i.babylonjs={})).component||(h.component={}))}(org||(org={}));