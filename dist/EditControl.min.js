var org;!function(t){var i,h;i=t.ssatguru||(t.ssatguru={}),function(t){var i,h,s=BABYLON.Axis,n=BABYLON.Color3,u=BABYLON.Matrix,r=BABYLON.Mesh,e=BABYLON.MeshBuilder,f=BABYLON.Path2,l=BABYLON.Quaternion,o=BABYLON.Space,a=BABYLON.StandardMaterial,c=BABYLON.Vector3;(h=i||(i={}))[h.TRANS=0]="TRANS",h[h.ROT=1]="ROT",h[h.SCALE=2]="SCALE";var v=function(){function t(t,i,h,s,n){var e=this;this.t=!0,this.i=!1,this.h=!1,this.s=1,this.u=Math.PI/18,this.l=.4,this.o=1,this.v=.02,this.M=.75,this.A=new u,this.L=new c(0,0,0),this.B=2,this.p=new c(0,0,0),this.N=new c(0,0,0),this.O="",this.C=!1,this.g=null,this.R=null,this.S=null,this.T=!1,this.k=!1,this.P=!1,this.j=!1,this.q=new c(0,0,0),this.D=new c(0,0,0),this.F=!1,this.G=new c(0,0,0),this.H=.25,this.I=new c(0,0,0),this.J=new c(0,0,0),this.K=new c(0,0,0),this.U=new c(0,0,0),this.V=new c(0,0,0),this.W=new c(0,0,0),this.$=new c(0,0,0),this._=!1,this.tt=0,this.it=!1,this.ht=!1,this.st=!1,this.nt=180,this.ut=new c(this.s,this.s,this.s),this.rt=new c(0,0,0),this.et=new c(0,0,0),this.ft=new c(0,0,0),this.lt=new u,this.ot=t,this.at=i,this.ct=h,this.o=s,this._=null!==n&&n,this.vt(),this.wt=t.getScene(),this.Mt=new w(t,10),t.computeWorldMatrix(!0),this.Yt=this.Xt(t),this.Zt(t),this.At=new r("EditControl",this.wt),this.At.rotationQuaternion=l.Identity(),this.At.visibility=0,this.At.isPickable=!1,this.Lt(this.wt),this.Bt().parent=this.At,this.dt().parent=this.At,this.pt=function(t){return e.Nt(t)},this.Ot=function(t){return e.zt(t)},this.Et=function(t){return e.bt(t)},h.addEventListener("pointerdown",this.pt,!1),h.addEventListener("pointerup",this.Ot,!1),h.addEventListener("pointermove",this.Et,!1),this.xt=function(){return e.yt()},this.wt.registerBeforeRender(this.xt)}return t.prototype.vt=function(){if(!this._&&(null==this.ot.rotationQuaternion||void 0==this.ot.rotationQuaternion))throw"Error: Eulerian is set to false but the mesh's rotationQuaternion is not set."},t.prototype.yt=function(){this.At.position=this.ot.getAbsolutePivotPoint(),this.Ct(),this.gt(),this.t?(this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L),this.Rt.lookAt(this.L,0,0,0,o.LOCAL)):(this.at.position.subtractToRef(this.At.position,this.L),this.Rt.lookAt(this.at.position,0,0,0,o.WORLD)),this.ht?this.St():this.it?this.Tt(this.kt,this.Pt,this.Qt):this.st&&this.Tt(this.jt,this.qt,this.Dt)},t.prototype.Ct=function(){if(this.t)if(null==this.ot.parent)if(this._){var t=this.ot.rotation;l.RotationYawPitchRollToRef(t.y,t.x,t.z,this.At.rotationQuaternion)}else this.At.rotationQuaternion.copyFrom(this.ot.rotationQuaternion);else this.ot.getWorldMatrix().getRotationMatrixToRef(this.lt),l.FromRotationMatrixToRef(this.lt,this.At.rotationQuaternion)},t.prototype.gt=function(){this.At.position.subtractToRef(this.at.position,this.p),c.FromFloatArrayToRef(this.at.getWorldMatrix().asArray(),8,this.N);var t=c.Dot(this.p,this.N)/this.N.length(),i=Math.abs(t/this.B);c.FromFloatsToRef(i,i,i,this.At.scaling)},t.prototype.St=function(){var t=Math.atan(this.L.y/this.L.z);this.L.z>=0?this.Ft.rotation.x=-t:this.Ft.rotation.x=-t-Math.PI;var i=Math.atan(this.L.x/this.L.z);this.L.z>=0?this.Gt.rotation.y=i:this.Gt.rotation.y=i+Math.PI;var h=Math.atan(this.L.x/this.L.y);this.L.y>=0?this.Ht.rotation.z=-h:this.Ht.rotation.z=-h-Math.PI},t.prototype.Tt=function(t,i,h){var s=this.L;t.rotation.x=0,t.rotation.y=0,t.rotation.z=0,i.rotation.x=0,i.rotation.y=0,i.rotation.z=0,h.rotation.x=0,h.rotation.y=0,h.rotation.z=0,s.x<=0&&s.y>=0&&s.z>=0?(t.rotation.z=3.14,h.rotation.y=3.14):s.x<=0&&s.y>=0&&s.z<=0?(t.rotation.y=3.14,i.rotation.y=3.14,h.rotation.y=3.14):s.x>=0&&s.y>=0&&s.z<=0?(t.rotation.x=3.14,i.rotation.y=3.14):s.x>=0&&s.y<=0&&s.z>=0?(i.rotation.z=3.14,h.rotation.x=3.14):s.x<=0&&s.y<=0&&s.z>=0?(t.rotation.z=3.14,i.rotation.z=3.14,h.rotation.z=3.14):s.x<=0&&s.y<=0&&s.z<=0?(t.rotation.y=3.14,i.rotation.x=3.14,h.rotation.z=3.14):s.x>=0&&s.y<=0&&s.z<=0&&(t.rotation.x=3.14,i.rotation.x=3.14,h.rotation.x=3.14)},t.prototype.switchTo=function(t,i){t.computeWorldMatrix(!0),this.ot=t,null!=i&&(this._=i),this.vt(),this.Zt(t),this.Mt=new w(t,10)},t.prototype.setUndoCount=function(t){this.Mt.setCapacity(t)},t.prototype.undo=function(){var t=this.Mt.undo();this.ot.computeWorldMatrix(!0),this.Zt(this.ot),this.It(t),this.Jt(t),this.Kt(t)},t.prototype.redo=function(){var t=this.Mt.redo();this.ot.computeWorldMatrix(!0),this.Zt(this.ot),this.It(t),this.Jt(t),this.Kt(t)},t.prototype.detach=function(){this.ct.removeEventListener("pointerdown",this.pt,!1),this.ct.removeEventListener("pointerup",this.Ot,!1),this.ct.removeEventListener("pointermove",this.Et,!1),this.wt.unregisterBeforeRender(this.xt),this.removeAllActionListeners(),this.Ut()},t.prototype.hide=function(){this.C=!0,this.it?(this.O="T",this.disableTranslation()):this.ht?(this.O="R",this.disableRotation()):this.st&&(this.O="S",this.disableScaling()),this.Vt()},t.prototype.Vt=function(){this.Wt.visibility=0,this.$t.visibility=0,this._t.visibility=0},t.prototype.ti=function(){this.Wt.visibility=this.M,this.$t.visibility=this.M,this._t.visibility=this.M},t.prototype.show=function(){this.C=!1,this.ti(),"T"==this.O?this.enableTranslation():"R"==this.O?this.enableRotation():"S"==this.O&&this.enableScaling()},t.prototype.isHidden=function(){return this.C},t.prototype.Ut=function(){this.At.dispose(),this.ii(),this.Mt=null},t.prototype.addActionListener=function(t){this.g=t},t.prototype.removeActionListener=function(){this.g=null},t.prototype.addActionStartListener=function(t){this.R=t},t.prototype.removeActionStartListener=function(){this.R=null},t.prototype.addActionEndListener=function(t){this.S=t},t.prototype.removeActionEndListener=function(){this.S=null},t.prototype.removeAllActionListeners=function(){this.g=null,this.R=null,this.S=null},t.prototype.Nt=function(t){var i=this;if(t.preventDefault(),this.T=!0,0==t.button){var h=this.wt.pick(this.wt.pointerX,this.wt.pointerY,function(t){if(i.it){if(t==i.hi||t==i.si||t==i.ni||t==i.kt||t==i.Pt||t==i.Qt||t==i.ui)return!0}else if(i.ht){if(t==i.Ft||t==i.Gt||t==i.Ht||t==i.ri)return!0}else if(i.st&&(t==i.ei||t==i.fi||t==i.li||t==i.jt||t==i.qt||t==i.Dt||t==i.oi))return!0;return!1},null,this.at);if(h.hit){this.ai=h.pickedMesh;var s=this.ai.getChildren();s.length>0?s[0].visibility=this.M:this.ai.visibility=this.M;var n=this.ai.name;"X"==n?this.ci.visibility=1:"Y"==n?this.vi.visibility=1:"Z"==n?this.wi.visibility=1:"XZ"==n?(this.ci.visibility=1,this.wi.visibility=1):"ZY"==n?(this.wi.visibility=1,this.vi.visibility=1):"YX"==n?(this.vi.visibility=1,this.ci.visibility=1):"ALL"==n&&(this.ci.visibility=1,this.vi.visibility=1,this.wi.visibility=1),this.Mi(!0),this.Yi=this.Xi(this.ai),null!=this.Yi?this.Zi=this.Ai():this.Zi=null,window.setTimeout(function(t,h){return i.Li(t,h)},0,this.at,this.ct)}}},t.prototype.Mi=function(t){this.P=t,t?(this.Bi(),this.di==i.ROT&&(this.tt=0),this.It(this.di)):this.Kt(this.di)},t.prototype.isEditing=function(){return this.P},t.prototype.Li=function(t,i){var h=i;t.detachControl(h)},t.prototype.isPointerOver=function(){return this.k},t.prototype.pi=function(){var t=this,i=this.wt.pick(this.wt.pointerX,this.wt.pointerY,function(i){if(t.it){if(i==t.hi||i==t.si||i==t.ni||i==t.kt||i==t.Pt||i==t.Qt||i==t.ui)return!0}else if(t.ht){if(i==t.Ft||i==t.Gt||i==t.Ht||i==t.ri)return!0}else if(t.st&&(i==t.ei||i==t.fi||i==t.li||i==t.jt||i==t.qt||i==t.Dt||i==t.oi))return!0;return!1},null,this.at);if(i.hit){if(i.pickedMesh!=this.Ni){if(this.k=!0,this.Oi(),this.Ni=i.pickedMesh,this.ht)this.zi=this.Ni.getChildren()[0].color,this.Ni.getChildren()[0].color=n.White();else{var h=this.Ni.getChildren();h.length>0?(this.Ei=h[0].material,h[0].material=this.bi):(this.Ei=this.Ni.material,this.Ni.material=this.bi)}"X"==this.Ni.name?this.Wt.color=n.White():"Y"==this.Ni.name?this.$t.color=n.White():"Z"==this.Ni.name&&(this._t.color=n.White())}}else this.k=!1,null!=this.Ni&&(this.xi(this.Ni),this.Ni=null)},t.prototype.Oi=function(){null!=this.Ni&&(this.Ni.visibility=0,this.xi(this.Ni))},t.prototype.xi=function(t){switch(t.name){case"X":this.Wt.color=n.Red();break;case"Y":this.$t.color=n.Green();break;case"Z":this._t.color=n.Blue()}if(this.ht)t.getChildren()[0].color=this.zi;else{var i=t.getChildren();i.length>0?i[0].material=this.Ei:t.material=this.Ei}},t.prototype.zt=function(t){this.T=!1,this.P&&(this.at.attachControl(this.ct),this.Mi(!1),this.yi(),null!=this.Ni&&(this.xi(this.Ni),this.Ni=null),this.Mt.add(this.di))},t.prototype.Bi=function(){this.it?this.di=i.TRANS:this.ht?this.di=i.ROT:this.st&&(this.di=i.SCALE)},t.prototype.Jt=function(t){null!=this.g&&this.g(t)},t.prototype.It=function(t){null!=this.R&&this.R(t)},t.prototype.Kt=function(t){null!=this.S&&this.S(t)},t.prototype.bt=function(t){if(this.T){if(this.P&&null!=this.Zi){var i=this.Ai();if(null!=i){if(this.ht)this.Ci(this.ot,this.ai,i,this.Zi);else{var h=i.subtract(this.Zi);if(0==h.x&&0==h.y&&0==h.z)return;this.it?this.gi(h):this.st&&this.t&&this.mi(h)}this.Zi=i,this.Jt(this.di)}}}else this.pi()},t.prototype.Xi=function(t){var i=t.name;if(this.it||this.st){if("XZ"==i)return this.Ri;if("ZY"==i)return this.Si;if("YX"==i)return this.Ti;if("ALL"==i)return this.Rt;this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L);var h=this.L;if("X"===i)return Math.abs(h.y)>Math.abs(h.z)?this.Ri:this.Ti;if("Z"===i)return Math.abs(h.y)>Math.abs(h.x)?this.Ri:this.Si;if("Y"===i)return Math.abs(h.z)>Math.abs(h.x)?this.Ti:this.Si}else{if(!this.ht)return null;switch(this.j=!1,this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L),h=this.L,i){case"X":return Math.abs(h.x)<.2?(this.j=!0,this.Rt):this.Si;case"Y":return Math.abs(h.y)<.2?(this.j=!0,this.Rt):this.Ri;case"Z":return Math.abs(h.z)<.2?(this.j=!0,this.Rt):this.Ti;default:return this.Rt}}},t.prototype.gi=function(t){null==this.ot.parent||this.ot.parent.scaling.x==this.ot.parent.scaling.y&&this.ot.parent.scaling.y==this.ot.parent.scaling.z?this.Zt(this.ot):this.Zt(this.At);var i=this.ai.name;"ALL"==i?this.q=t:(this.q.x=0,this.q.y=0,this.q.z=0,"X"!=i&&"XZ"!=i&&"YX"!=i||(this.t?this.q.x=c.Dot(t,this.J)/this.J.length():this.q.x=t.x),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.t?this.q.y=c.Dot(t,this.K)/this.K.length():this.q.y=t.y),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.t?this.q.z=c.Dot(t,this.U)/this.U.length():this.q.z=t.z)),this.ki(this.ot,this.q,this.t),this.Pi&&(this.ot.position.x=Math.max(this.ot.position.x,this.Pi.x),this.ot.position.y=Math.max(this.ot.position.y,this.Pi.y),this.ot.position.z=Math.max(this.ot.position.z,this.Pi.z)),this.Qi&&(this.ot.position.x=Math.min(this.ot.position.x,this.Qi.x),this.ot.position.y=Math.min(this.ot.position.y,this.Qi.y),this.ot.position.z=Math.min(this.ot.position.z,this.Qi.z)),this.ot.computeWorldMatrix(!0)},t.prototype.ki=function(t,i,h){if(this.i){var s=!1;if(this.D.addInPlace(i),Math.abs(this.D.x)>this.ut.x&&(this.D.x>0?i.x=this.ut.x:i.x=-this.ut.x,s=!0),Math.abs(this.D.y)>this.ut.y&&(this.D.y>0?i.y=this.ut.y:i.y=-this.ut.y,s=!0),Math.abs(this.D.z)>this.ut.z&&(this.D.z>0?i.z=this.ut.z:i.z=-this.ut.z,s=!0),!s)return;Math.abs(i.x)!==this.ut.x&&(i.x=0),Math.abs(i.y)!==this.ut.y&&(i.y=0),Math.abs(i.z)!==this.ut.z&&(i.z=0),c.FromFloatsToRef(0,0,0,this.D),s=!1}h?(this.J.normalizeToRef(this.rt),this.K.normalizeToRef(this.et),this.U.normalizeToRef(this.ft),this.ot.translate(this.rt,i.x,o.WORLD),this.ot.translate(this.et,i.y,o.WORLD),this.ot.translate(this.ft,i.z,o.WORLD)):null==this.ot.parent?this.ot.position.addInPlace(i):this.ot.setAbsolutePosition(i.addInPlace(this.ot.absolutePosition))},t.prototype.mi=function(t){this.Zt(this.ot),this.I.x=0,this.I.y=0,this.I.z=0;var i=this.ai.name;"X"!=i&&"XZ"!=i&&"YX"!=i||(this.I.x=c.Dot(t,this.J)/this.J.length(),this.ot.scaling.x<0&&(this.I.x=-this.I.x)),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.I.y=c.Dot(t,this.K)/this.K.length(),this.ot.scaling.y<0&&(this.I.y=-this.I.y)),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.I.z=c.Dot(t,this.U)/this.U.length(),this.ot.scaling.z<0&&(this.I.z=-this.I.z));var h=this.Yt;if(this.I.x=this.I.x/h.x,this.I.y=this.I.y/h.y,this.I.z=this.I.z/h.z,"ALL"==i){var s=c.Dot(t,this.at.upVector);s/=Math.max(h.x,h.y,h.z),this.I.copyFromFloats(s,s,s)}else{var n=!1;"XZ"==i?(n=!0,Math.abs(this.I.x)>Math.abs(this.I.z)?this.I.z=this.I.x:this.I.x=this.I.z):"ZY"==i?(n=!0,Math.abs(this.I.z)>Math.abs(this.I.y)?this.I.y=this.I.z:this.I.z=this.I.y):"YX"==i&&(n=!0,Math.abs(this.I.y)>Math.abs(this.I.x)?this.I.x=this.I.y:this.I.y=this.I.x),n&&(this.At.position.subtractToRef(this.at.position,this.p),s=c.Dot(t,this.p),this.I.x=Math.abs(this.I.x),this.I.y=Math.abs(this.I.y),this.I.z=Math.abs(this.I.z),s>0?(this.ot.scaling.x>0&&(this.I.x=-this.I.x),this.ot.scaling.y>0&&(this.I.y=-this.I.y),this.ot.scaling.z>0&&(this.I.z=-this.I.z)):(this.ot.scaling.x<0&&(this.I.x=-this.I.x),this.ot.scaling.y<0&&(this.I.y=-this.I.y),this.ot.scaling.z<0&&(this.I.z=-this.I.z)))}this.ji(this.ot,this.I),this.qi&&(this.ot.scaling.x=Math.max(this.ot.scaling.x,this.qi.x),this.ot.scaling.y=Math.max(this.ot.scaling.y,this.qi.y),this.ot.scaling.z=Math.max(this.ot.scaling.z,this.qi.z)),this.Di&&(this.ot.scaling.x=Math.min(this.ot.scaling.x,this.Di.x),this.ot.scaling.y=Math.min(this.ot.scaling.y,this.Di.y),this.ot.scaling.z=Math.min(this.ot.scaling.z,this.Di.z))},t.prototype.ji=function(t,i){if(this.F){var h=!1;if(this.G.addInPlace(i),Math.abs(this.G.x)>this.H&&(i.x>0?i.x=this.H:i.x=-this.H,h=!0),Math.abs(this.G.y)>this.H&&(i.y>0?i.y=this.H:i.y=-this.H,h=!0),Math.abs(this.G.z)>this.H&&(i.z>0?i.z=this.H:i.z=-this.H,h=!0),!h)return;Math.abs(i.x)!==this.H&&0!==i.x&&(i.x=0),Math.abs(i.y)!==this.H&&0!==i.y&&(i.y=0),Math.abs(i.z)!==this.H&&0!==i.z&&(i.z=0),c.FromFloatsToRef(0,0,0,this.G),h=!1}t.scaling.addInPlace(i)},t.prototype.Zt=function(t){var i=t.getWorldMatrix();c.FromFloatArrayToRef(i.m,0,this.J),c.FromFloatArrayToRef(i.m,4,this.K),c.FromFloatArrayToRef(i.m,8,this.U)},t.prototype.Fi=function(){var t=this.At.getWorldMatrix();c.FromFloatArrayToRef(t.m,0,this.V),c.FromFloatArrayToRef(t.m,4,this.W),c.FromFloatArrayToRef(t.m,8,this.$)},t.prototype.Xt=function(t){var i=t.getBoundingInfo().boundingBox,h=i.maximum.subtract(i.minimum);return 0==h.x&&(h.x=1),0==h.y&&(h.y=1),0==h.z&&(h.z=1),h},t.prototype.refreshBoundingInfo=function(){this.Yt=this.Xt(this.ot)},t.prototype.Ci=function(t,i,h,n){if(!this.t||null==this.ot.parent||this.ot.parent.scaling.x==this.ot.parent.scaling.y&&this.ot.parent.scaling.y==this.ot.parent.scaling.z){this.Zt(this.ot);var u,r=0;i==this.Ft?u=this.t?this.J:s.X:i==this.Gt?u=this.t?this.K:s.Y:i==this.Ht&&(u=this.t?this.U:s.Z),this.At.position.subtractToRef(this.at.position,this.p),this.j?(r=this.Gi(n,h,this.at.position,this.p,u),this.wt.useRightHandedSystem&&(r=-r)):r=this.Hi(n,h,t.getAbsolutePivotPoint(),this.p),this.h&&(this.tt+=r,r=0,Math.abs(this.tt)>=this.u&&(r=this.tt>0?this.u:-this.u,this.tt=0)),0!==r&&(this.p.normalize(),i==this.ri?t.rotate(this.p,-r,o.WORLD):(c.Dot(u,this.p)>=0&&(r=-r),t.rotate(u,r,o.WORLD)),this._&&(t.rotation=t.rotationQuaternion.toEulerAngles(),t.rotationQuaternion=null))}},t.prototype.Ai=function(){var t=this,i=this.wt.pick(this.wt.pointerX,this.wt.pointerY,function(i){return i==t.Yi},null,this.at);return i.hit?i.pickedPoint:null},t.prototype.yi=function(){this.ci.visibility=0,this.vi.visibility=0,this.wi.visibility=0},t.prototype.Ii=function(t){this.it&&(this.Ji.visibility=t,this.Ki.visibility=t,this.Ui.visibility=t,this.Vi.visibility=t,this.Wi.visibility=t,this.$i.visibility=t,this._i.visibility=t),this.ht&&(this.th.visibility=t,this.ih.visibility=t,this.hh.visibility=t,this.sh.visibility=t),this.st&&(this.nh.visibility=t,this.uh.visibility=t,this.rh.visibility=t,this.eh.visibility=t,this.fh.visibility=t,this.lh.visibility=t,this.oh.visibility=t)},t.prototype.getRotationQuaternion=function(){return this.At.rotationQuaternion},t.prototype.getPosition=function(){return this.At.position},t.prototype.isTranslationEnabled=function(){return this.it},t.prototype.enableTranslation=function(){null==this.hi&&(this.ah(),this.vh.parent=this.At),this.Oi(),this.it||(this.Ji.visibility=this.M,this.Ki.visibility=this.M,this.Ui.visibility=this.M,this.Vi.visibility=this.M,this.Wi.visibility=this.M,this.$i.visibility=this.M,this._i.visibility=this.M,this.it=!0,this.disableRotation(),this.disableScaling())},t.prototype.disableTranslation=function(){this.it&&(this.Ji.visibility=0,this.Ki.visibility=0,this.Ui.visibility=0,this.Vi.visibility=0,this.Wi.visibility=0,this.$i.visibility=0,this._i.visibility=0,this.it=!1)},t.prototype.isRotationEnabled=function(){return this.ht},t.prototype.returnEuler=function(t){this._=t},t.prototype.enableRotation=function(){null==this.wh&&(this.Mh(),this.wh.parent=this.At),this.Oi(),this.ht||(this.th.visibility=this.M,this.ih.visibility=this.M,this.hh.visibility=this.M,this.sh.visibility=this.M,this.Yh.visibility=this.M,this.ht=!0,this.disableTranslation(),this.disableScaling())},t.prototype.disableRotation=function(){this.ht&&(this.th.visibility=0,this.ih.visibility=0,this.hh.visibility=0,this.sh.visibility=0,this.Yh.visibility=0,this.ht=!1)},t.prototype.isScalingEnabled=function(){return this.st},t.prototype.enableScaling=function(){null==this.ei&&(this.Xh(),this.Zh.parent=this.At),this.Oi(),this.st||(this.nh.visibility=this.M,this.uh.visibility=this.M,this.rh.visibility=this.M,this.eh.visibility=this.M,this.fh.visibility=this.M,this.lh.visibility=this.M,this.oh.visibility=this.M,this.st=!0,this.disableTranslation(),this.disableRotation())},t.prototype.disableScaling=function(){this.st&&(this.nh.visibility=0,this.uh.visibility=0,this.rh.visibility=0,this.eh.visibility=0,this.fh.visibility=0,this.lh.visibility=0,this.oh.visibility=0,this.st=!1)},t.prototype.setScaleBounds=function(t,i){this.qi=t||null,this.Di=i||null,null!=this.qi&&(0==this.qi.x&&(this.qi.x=1e-8),0==this.qi.y&&(this.qi.y=1e-8),0==this.qi.z&&(this.qi.z=1e-8))},t.prototype.removeScaleBounds=function(){this.qi=null,this.Di=null},t.prototype.setTransBounds=function(t,i){this.Pi=t||null,this.Qi=i||null},t.prototype.removeTransBounds=function(){this.Pi=null,this.Qi=null},t.prototype.setRotBounds=function(t,i){this.Ah=t||null,this.Lh=i||null},t.prototype.removeRotBounds=function(){this.Ah=null,this.Lh=null},t.prototype.Bt=function(){var t=new r("guideCtl",this.wt);this.ci=r.CreateLines("bxAxis",[new c(-100,0,0),new c(100,0,0)],this.wt),this.vi=r.CreateLines("byAxis",[new c(0,-100,0),new c(0,100,0)],this.wt),this.wi=r.CreateLines("bzAxis",[new c(0,0,-100),new c(0,0,100)],this.wt),this.ci.isPickable=!1,this.vi.isPickable=!1,this.wi.isPickable=!1,this.ci.parent=t,this.vi.parent=t,this.wi.parent=t,this.ci.color=n.Red(),this.vi.color=n.Green(),this.wi.color=n.Blue(),this.yi();var i=this.l*this.o*.75;return this.Wt=r.CreateLines("xAxis",[new c(0,0,0),new c(i,0,0)],this.wt),this.$t=r.CreateLines("yAxis",[new c(0,0,0),new c(0,i,0)],this.wt),this._t=r.CreateLines("zAxis",[new c(0,0,0),new c(0,0,i)],this.wt),this.Wt.isPickable=!1,this.$t.isPickable=!1,this._t.isPickable=!1,this.Wt.parent=t,this.$t.parent=t,this._t.parent=t,this.Wt.color=n.Red(),this.$t.color=n.Green(),this._t.color=n.Blue(),this.Wt.renderingGroupId=1,this.$t.renderingGroupId=1,this._t.renderingGroupId=1,t},t.prototype.dt=function(){this.Rt=r.CreatePlane("pALL",5,this.wt),this.Ri=r.CreatePlane("pXZ",5,this.wt),this.Si=r.CreatePlane("pZY",5,this.wt),this.Ti=r.CreatePlane("pYX",5,this.wt),this.Rt.isPickable=!1,this.Ri.isPickable=!1,this.Si.isPickable=!1,this.Ti.isPickable=!1,this.Rt.visibility=0,this.Ri.visibility=0,this.Si.visibility=0,this.Ti.visibility=0,this.Rt.renderingGroupId=1,this.Ri.renderingGroupId=1,this.Si.renderingGroupId=1,this.Ti.renderingGroupId=1,this.Rt.lookAt(this.at.position),this.Ri.rotate(s.X,1.57),this.Si.rotate(s.Y,1.57);var t=new r("pickPlanes",this.wt);return this.Rt.parent=t,this.Ri.parent=t,this.Si.parent=t,this.Ti.parent=t,t},t.prototype.ah=function(){var t=2*this.v*this.o,i=this.l*this.o;this.vh=new r("tarnsCtl",this.wt),this.hi=this.Bh(t/2,i),this.hi.name="X",this.si=this.hi.clone("Y"),this.ni=this.hi.clone("Z"),this.kt=e.CreatePlane("XZ",{size:2*t},this.wt),this.Pt=e.CreatePlane("ZY",{size:2*t},this.wt),this.Qt=e.CreatePlane("YX",{size:2*t},this.wt),this.kt.rotation.x=1.57,this.Pt.rotation.y=-1.57,this.kt.position.x=t,this.kt.position.z=t,this.Pt.position.z=t,this.Pt.position.y=t,this.Qt.position.y=t,this.Qt.position.x=t,this.kt.bakeCurrentTransformIntoVertices(),this.Pt.bakeCurrentTransformIntoVertices(),this.Qt.bakeCurrentTransformIntoVertices(),this.ui=r.CreateBox("ALL",2*t,this.wt),this.hi.parent=this.vh,this.si.parent=this.vh,this.ni.parent=this.vh,this.kt.parent=this.vh,this.Pt.parent=this.vh,this.Qt.parent=this.vh,this.ui.parent=this.vh,this.hi.rotation.y=1.57,this.si.rotation.x-=1.57,this.hi.visibility=0,this.si.visibility=0,this.ni.visibility=0,this.kt.visibility=0,this.Pt.visibility=0,this.Qt.visibility=0,this.ui.visibility=0,this.hi.isPickable=!1,this.si.isPickable=!1,this.ni.isPickable=!1,this.kt.isPickable=!1,this.Pt.isPickable=!1,this.Qt.isPickable=!1,this.ui.isPickable=!1;var h=i/5,s=t;this.Ji=r.CreateCylinder("tEndX",h,0,s,6,1,this.wt),this.Ki=this.Ji.clone("tEndY"),this.Ui=this.Ji.clone("tEndZ"),this.Vi=this.dh("XZ",1.75*s,this.wt),this.Wi=this.Vi.clone("ZY"),this.$i=this.Vi.clone("YX"),this._i=e.CreatePolyhedron("tEndAll",{type:1,size:s/2},this.wt),this.Ji.rotation.x=1.57,this.Ki.rotation.x=1.57,this.Ui.rotation.x=1.57,this.Wi.rotation.z=1.57,this.$i.rotation.x=-1.57,this.Vi.position.x=t,this.Vi.position.z=t,this.Wi.position.z=t,this.Wi.position.y=t,this.$i.position.y=t,this.$i.position.x=t,this.Ji.parent=this.hi,this.Ki.parent=this.si,this.Ui.parent=this.ni,this.Vi.parent=this.kt,this.Wi.parent=this.Pt,this.$i.parent=this.Qt,this._i.parent=this.ui,this.Ji.position.z=i-h/2,this.Ki.position.z=i-h/2,this.Ui.position.z=i-h/2,this.Ji.material=this.ph,this.Ki.material=this.Nh,this.Ui.material=this.Oh,this.Vi.material=this.Nh,this.Wi.material=this.ph,this.$i.material=this.Oh,this._i.material=this.zh,this.Ji.renderingGroupId=2,this.Ki.renderingGroupId=2,this.Ui.renderingGroupId=2,this.Vi.renderingGroupId=2,this.Wi.renderingGroupId=2,this.$i.renderingGroupId=2,this._i.renderingGroupId=2,this.Ji.isPickable=!1,this.Ki.isPickable=!1,this.Ui.isPickable=!1,this.Vi.isPickable=!1,this.Wi.isPickable=!1,this.$i.isPickable=!1,this._i.isPickable=!1},t.prototype.dh=function(t,i,h){var s=new f(i/2,-i/2).addLineTo(i/2,i/2).addLineTo(-i/2,i/2).addLineTo(i/2,-i/2);return new BABYLON.PolygonMeshBuilder(t,s,h).build()},t.prototype.setRotGuideFull=function(t){this.nt=t?360:180,null!=this.wh&&(this.wh.dispose(),this.ri.dispose(),this.wh=null,this.enableRotation())},t.prototype.Mh=function(){var t=this.l*this.o*2;this.wh=new r("rotCtl",this.wt),this.Ft=this.Eh(t/2,this.nt),this.Ft.name="X",this.Gt=this.Eh(t/2,this.nt),this.Gt.name="Y",this.Ht=this.Eh(t/2,this.nt),this.Ht.name="Z",this.ri=this.Eh(t/1.75,360),this.ri.name="ALL",this.Ft.rotation.z=1.57,this.Ht.rotation.x=-1.57,this.Ft.bakeCurrentTransformIntoVertices(),this.Ht.bakeCurrentTransformIntoVertices(),this.ri.rotation.x=1.57,this.Ft.parent=this.wh,this.Gt.parent=this.wh,this.Ht.parent=this.wh,this.ri.parent=this.Rt,this.Ft.visibility=0,this.Gt.visibility=0,this.Ht.visibility=0,this.ri.visibility=0,this.Ft.isPickable=!1,this.Gt.isPickable=!1,this.Ht.isPickable=!1,this.ri.isPickable=!1;var i=t;this.th=this.bh(i/2,this.nt,!1),this.ih=this.th.clone(""),this.hh=this.th.clone(""),this.sh=this.bh(i/1.75,360,!1),this.Yh=this.bh(i/2,360,!1),this.th.parent=this.Ft,this.ih.parent=this.Gt,this.hh.parent=this.Ht,this.th.rotation.z=1.57,this.hh.rotation.x=-1.57,this.sh.parent=this.ri,this.Yh.parent=this.ri,this.th.color=n.Red(),this.ih.color=n.Green(),this.hh.color=n.Blue(),this.sh.color=n.Yellow(),this.Yh.color=n.Gray(),this.th.renderingGroupId=2,this.ih.renderingGroupId=2,this.hh.renderingGroupId=2,this.sh.renderingGroupId=2,this.Yh.renderingGroupId=2,this.th.isPickable=!1,this.ih.isPickable=!1,this.hh.isPickable=!1,this.sh.isPickable=!1,this.Yh.isPickable=!1},t.prototype.Bh=function(t,i){var h=[new c(t,t,0),new c(-t,t,0),new c(-t,-t,0),new c(t,-t,0),new c(t,t,0)],s=[new c(0,0,0),new c(0,0,i)];return r.ExtrudeShape("",h,s,1,0,2,this.wt)},t.prototype.bh=function(t,i,h){null===i&&(i=360);for(var s,n,u=[],e=3.14/180,f=0,l=0;l<=i;l+=5)s=t*Math.cos(l*e),n=90==l?t:270==l?-t:t*Math.sin(l*e),u[f]=new c(s,0,n),f++;if(h)for(t-=.04,l=0;l<=i;l+=5)s=t*Math.cos(l*e),n=90==l?t:270==l?-t:t*Math.sin(l*e),u[f]=new c(s,0,n),f++;return r.CreateLines("",u,this.wt)},t.prototype.Eh=function(t,i){null===i&&(i=360);for(var h,s,n=[],u=0,e=0;e<=i;e+=30)h=t*Math.cos(e*(3.14/180)),s=90==e?t:270==e?-t:t*Math.sin(e*(3.14/180)),n[u]=new c(h,0,s),u++;return r.CreateTube("",n,this.v*this.o*2,3,null,BABYLON.Mesh.xh,this.wt)},t.prototype.Xh=function(){var t=2*this.v*this.o,i=this.l*this.o;this.Zh=new r("sCtl",this.wt),this.ei=this.Bh(t/2,i),this.ei.name="X",this.fi=this.ei.clone("Y"),this.li=this.ei.clone("Z"),this.jt=e.CreatePlane("XZ",{size:2*t},this.wt),this.qt=e.CreatePlane("ZY",{size:2*t},this.wt),this.Dt=e.CreatePlane("YX",{size:2*t},this.wt),this.jt.rotation.x=1.57,this.qt.rotation.y=-1.57,this.jt.position.x=t,this.jt.position.z=t,this.qt.position.z=t,this.qt.position.y=t,this.Dt.position.y=t,this.Dt.position.x=t,this.jt.bakeCurrentTransformIntoVertices(),this.qt.bakeCurrentTransformIntoVertices(),this.Dt.bakeCurrentTransformIntoVertices(),this.oi=r.CreateBox("ALL",2*t,this.wt),this.ei.parent=this.Zh,this.fi.parent=this.Zh,this.li.parent=this.Zh,this.oi.parent=this.Zh,this.jt.parent=this.Zh,this.qt.parent=this.Zh,this.Dt.parent=this.Zh,this.ei.rotation.y=1.57,this.fi.rotation.x-=1.57,this.ei.visibility=0,this.fi.visibility=0,this.li.visibility=0,this.jt.visibility=0,this.qt.visibility=0,this.Dt.visibility=0,this.oi.visibility=0,this.ei.isPickable=!1,this.fi.isPickable=!1,this.li.isPickable=!1,this.jt.isPickable=!1,this.qt.isPickable=!1,this.Dt.isPickable=!1,this.oi.isPickable=!1;var h=t;this.nh=r.CreateBox("",h,this.wt),this.uh=this.nh.clone(""),this.rh=this.nh.clone(""),this.eh=this.dh("XZ",1.75*h,this.wt),this.fh=this.eh.clone("ZY"),this.lh=this.eh.clone("YX"),this.oh=e.CreatePolyhedron("sEndAll",{type:1,size:h/2},this.wt),this.fh.rotation.z=1.57,this.lh.rotation.x=-1.57,this.eh.position.x=t,this.eh.position.z=t,this.fh.position.z=t,this.fh.position.y=t,this.lh.position.y=t,this.lh.position.x=t,this.nh.parent=this.ei,this.uh.parent=this.fi,this.rh.parent=this.li,this.eh.parent=this.jt,this.fh.parent=this.qt,this.lh.parent=this.Dt,this.oh.parent=this.oi,this.nh.position.z=i-h/2,this.uh.position.z=i-h/2,this.rh.position.z=i-h/2,this.nh.material=this.ph,this.uh.material=this.Nh,this.rh.material=this.Oh,this.eh.material=this.Nh,this.fh.material=this.ph,this.lh.material=this.Oh,this.oh.material=this.zh,this.nh.renderingGroupId=2,this.uh.renderingGroupId=2,this.rh.renderingGroupId=2,this.eh.renderingGroupId=2,this.fh.renderingGroupId=2,this.lh.renderingGroupId=2,this.oh.renderingGroupId=2,this.nh.isPickable=!1,this.uh.isPickable=!1,this.rh.isPickable=!1,this.eh.isPickable=!1,this.fh.isPickable=!1,this.lh.isPickable=!1,this.oh.isPickable=!1},t.prototype.yh=function(t){var i=c.Cross(this.J,this.K);return c.Dot(i,this.U)<0},t.prototype.setVisibility=function(t){this.M=t},t.prototype.setLocal=function(t){this.t!=t&&(this.t=t,t||(this.At.rotationQuaternion=l.Identity()))},t.prototype.isLocal=function(){return this.t},t.prototype.setTransSnap=function(t){this.i=t},t.prototype.setRotSnap=function(t){this.h=t},t.prototype.setScaleSnap=function(t){this.F=t},t.prototype.setTransSnapValue=function(t){this.ut.copyFromFloats(t,t,t),this.s=t},t.prototype.setRotSnapValue=function(t){this.u=t},t.prototype.setScaleSnapValue=function(t){this.H=t},t.prototype.Gi=function(t,i,h,s,n){var u=c.Dot(s,n);n.scaleToRef(u,this.rt),h.addToRef(this.rt,this.et);var r=this.et;this.at.getWorldMatrix().invertToRef(this.lt),c.TransformCoordinatesToRef(this.et,this.lt,this.et);var e=0;r.x>=0&&r.y>=0?e=1:r.x<=0&&r.y>=0?e=2:r.x<=0&&r.y<=0?e=3:r.x>=0&&r.y<=0&&(e=4),c.TransformCoordinatesToRef(t,this.lt,this.rt),c.TransformCoordinatesToRef(i,this.lt,this.et),this.et.subtractInPlace(this.rt);var f=this.et,l=f.length(),o="";f.x>=0&&f.y>=0?o=f.x>=f.y?"r":"u":f.x<=0&&f.y>=0?o=-f.x>=f.y?"l":"u":f.x<=0&&f.y<=0?o=-f.x>=-f.y?"l":"d":f.x>=0&&f.y<=0&&(o=f.x>=-f.y?"r":"d");var a=0;return"d"==o?a=1==e||4==e?1:-1:"u"==o?a=1==e||4==e?-1:1:"r"==o?a=2==e||1==e?1:-1:"l"==o&&(a=2==e||1==e?-1:1),a*l},t.prototype.Hi=function(t,i,h,s){t.subtractToRef(h,this.rt),i.subtractToRef(h,this.et),c.CrossToRef(this.rt,this.et,this.ft);var n=Math.asin(this.ft.length()/(this.rt.length()*this.et.length()));return c.Dot(this.ft,s)>0&&(n*=-1),n},t.prototype.Lt=function(i){this.ph=t.Ch("redMat",n.Red(),i),this.Nh=t.Ch("greenMat",n.Green(),i),this.Oh=t.Ch("blueMat",n.Blue(),i),this.bi=t.Ch("whiteMat",n.White(),i),this.zh=t.Ch("whiteMat",n.Yellow(),i)},t.prototype.ii=function(){this.ph.dispose(),this.Nh.dispose(),this.Oh.dispose(),this.bi.dispose(),this.zh.dispose()},t.Ch=function(t,i,h){var s=new a(t,h);return s.emissiveColor=i,s.diffuseColor=n.Black(),s.specularColor=n.Black(),s.backFaceCulling=!1,s},t}();t.EditControl=v;var w=function(){function t(t,i){this.lastMax=10,this.acts=new Array,this.last=-1,this.current=-1,this.mesh=t,this.lastMax=i-1,this.add()}return t.prototype.setCapacity=function(t){0!=t?(this.lastMax=t-1,this.last=-1,this.current=-1,this.acts=new Array,this.add()):console.error("capacity should be more than zero")},t.prototype.add=function(t){void 0===t&&(t=null);var i=new M(this.mesh,t);this.current<this.last&&(this.acts.splice(this.current+1),this.last=this.current),this.last==this.lastMax?(this.acts.shift(),this.acts.push(i)):(this.acts.push(i),this.last++,this.current++)},t.prototype.undo=function(){if(this.current>0){var t=this.acts[this.current].getActionType();return this.current--,this.acts[this.current].perform(this.mesh),t}},t.prototype.redo=function(){if(this.current<this.last)return this.current++,this.acts[this.current].perform(this.mesh),this.acts[this.current].getActionType()},t}();t.ActHist=w;var M=function(){function t(t,i){this.gh=t.position.clone(),null==t.rotationQuaternion?(this.mh=null,this.Rh=t.rotation.clone()):(this.mh=t.rotationQuaternion.clone(),this.Rh=null),this.Sh=t.scaling.clone(),this.Th=i}return t.prototype.getActionType=function(){return this.Th},t.prototype.perform=function(t){t.position.copyFrom(this.gh),null==t.rotationQuaternion?null!=this.Rh?t.rotation.copyFrom(this.Rh):t.rotation.copyFrom(this.mh.toEulerAngles()):null!=this.mh?t.rotationQuaternion.copyFrom(this.mh):t.rotationQuaternion.copyFrom(l.RotationYawPitchRoll(this.Rh.y,this.Rh.x,this.Rh.z)),t.scaling.copyFrom(this.Sh)},t}();t.Act=M}((h=i.babylonjs||(i.babylonjs={})).component||(h.component={}))}(org||(org={}));