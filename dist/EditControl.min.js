var org;!function(t){var i,h;i=t.ssatguru||(t.ssatguru={}),function(t){var i,h,s=BABYLON.Axis,n=BABYLON.Color3,u=BABYLON.Matrix,r=BABYLON.Mesh,e=BABYLON.MeshBuilder,f=BABYLON.Path2,l=BABYLON.Quaternion,o=BABYLON.Space,a=BABYLON.StandardMaterial,c=BABYLON.Vector3;(h=i||(i={}))[h.TRANS=0]="TRANS",h[h.ROT=1]="ROT",h[h.SCALE=2]="SCALE";var v=function(){function t(t,i,h,s,n){var e=this;this.t=!0,this.i=!1,this.h=!1,this.s=1,this.u=Math.PI/18,this.l=.4,this.o=1,this.v=.02,this.M=.75,this.A=new u,this.L=new c(0,0,0),this.B=2,this.p=new c(0,0,0),this.N=new c(0,0,0),this.O="",this.C=!1,this.g=null,this.R=null,this.S=null,this.T=!1,this.k=!1,this.P=!1,this.j=!1,this.q=new c(0,0,0),this.D=new c(0,0,0),this.F=!1,this.G=new c(0,0,0),this.H=.25,this.I=new c(0,0,0),this.J=new c(0,0,0),this.K=new c(0,0,0),this.U=new c(0,0,0),this.V=new c(0,0,0),this.W=new c(0,0,0),this.$=new c(0,0,0),this._=!1,this.tt=0,this.it=!1,this.ht=!1,this.st=!1,this.nt=180,this.ut=new c(this.s,this.s,this.s),this.rt=new c(0,0,0),this.et=new c(0,0,0),this.ft=new c(0,0,0),this.lt=new u,this.ot=t,this.at=i,this.ct=h,this.o=s,this._=null!==n&&n,this.vt(),this.wt=t.getScene(),this.Mt=new w(t,10),t.computeWorldMatrix(!0),this.Yt=this.Xt(t),this.Zt(t),this.At=new r("EditControl",this.wt),this.At.rotationQuaternion=l.Identity(),this.At.visibility=0,this.At.isPickable=!1,this.Lt(this.wt),this.Bt().parent=this.At,this.dt().parent=this.At,this.pt=function(t){return e.Nt(t)},this.Ot=function(t){return e.zt(t)},this.Et=function(t){return e.bt(t)},h.addEventListener("pointerdown",this.pt,!1),h.addEventListener("pointerup",this.Ot,!1),h.addEventListener("pointermove",this.Et,!1),this.xt=function(){return e.yt()},this.wt.registerBeforeRender(this.xt)}return t.prototype.vt=function(){if(!this._&&(null==this.ot.rotationQuaternion||void 0==this.ot.rotationQuaternion))throw"Error: Eulerian is set to false but the mesh's rotationQuaternion is not set."},t.prototype.yt=function(){this.At.position=this.ot.getAbsolutePivotPoint(),this.Ct(),this.gt(),this.t?(this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L),this.Rt.lookAt(this.L,0,0,0,o.LOCAL)):(this.at.position.subtractToRef(this.At.position,this.L),this.Rt.lookAt(this.at.position,0,0,0,o.WORLD)),this.ht?this.St():this.it?this.Tt(this.kt,this.Pt,this.Qt):this.st&&this.Tt(this.jt,this.qt,this.Dt)},t.prototype.Ct=function(){if(this.t)if(null==this.ot.parent)if(this._){var t=this.ot.rotation;l.RotationYawPitchRollToRef(t.y,t.x,t.z,this.At.rotationQuaternion)}else this.At.rotationQuaternion.copyFrom(this.ot.rotationQuaternion);else{if(this.Ft(this.ot))return;this.ot.getWorldMatrix().getRotationMatrixToRef(this.lt),l.FromRotationMatrixToRef(this.lt,this.At.rotationQuaternion)}},t.prototype.Ft=function(t){if(null==t.parent)return!1;for(;null!=t.parent;){if(t.parent.scaling.x!=t.parent.scaling.y||t.parent.scaling.y!=t.parent.scaling.z)return!0;t=t.parent}return!1},t.prototype.gt=function(){this.At.position.subtractToRef(this.at.position,this.p),c.FromFloatArrayToRef(this.at.getWorldMatrix().asArray(),8,this.N);var t=c.Dot(this.p,this.N)/this.N.length(),i=Math.abs(t/this.B);c.FromFloatsToRef(i,i,i,this.At.scaling)},t.prototype.St=function(){var t=Math.atan(this.L.y/this.L.z);this.L.z>=0?this.Gt.rotation.x=-t:this.Gt.rotation.x=-t-Math.PI;var i=Math.atan(this.L.x/this.L.z);this.L.z>=0?this.Ht.rotation.y=i:this.Ht.rotation.y=i+Math.PI;var h=Math.atan(this.L.x/this.L.y);this.L.y>=0?this.It.rotation.z=-h:this.It.rotation.z=-h-Math.PI},t.prototype.Tt=function(t,i,h){var s=this.L;t.rotation.x=0,t.rotation.y=0,t.rotation.z=0,i.rotation.x=0,i.rotation.y=0,i.rotation.z=0,h.rotation.x=0,h.rotation.y=0,h.rotation.z=0,s.x<=0&&s.y>=0&&s.z>=0?(t.rotation.z=3.14,h.rotation.y=3.14):s.x<=0&&s.y>=0&&s.z<=0?(t.rotation.y=3.14,i.rotation.y=3.14,h.rotation.y=3.14):s.x>=0&&s.y>=0&&s.z<=0?(t.rotation.x=3.14,i.rotation.y=3.14):s.x>=0&&s.y<=0&&s.z>=0?(i.rotation.z=3.14,h.rotation.x=3.14):s.x<=0&&s.y<=0&&s.z>=0?(t.rotation.z=3.14,i.rotation.z=3.14,h.rotation.z=3.14):s.x<=0&&s.y<=0&&s.z<=0?(t.rotation.y=3.14,i.rotation.x=3.14,h.rotation.z=3.14):s.x>=0&&s.y<=0&&s.z<=0&&(t.rotation.x=3.14,i.rotation.x=3.14,h.rotation.x=3.14)},t.prototype.switchTo=function(t,i){t.computeWorldMatrix(!0),this.ot=t,null!=i&&(this._=i),this.vt(),this.Zt(t),this.Mt=new w(t,10)},t.prototype.setUndoCount=function(t){this.Mt.setCapacity(t)},t.prototype.undo=function(){var t=this.Mt.undo();this.ot.computeWorldMatrix(!0),this.Zt(this.ot),this.Jt(t),this.Kt(t),this.Ut(t)},t.prototype.redo=function(){var t=this.Mt.redo();this.ot.computeWorldMatrix(!0),this.Zt(this.ot),this.Jt(t),this.Kt(t),this.Ut(t)},t.prototype.detach=function(){this.ct.removeEventListener("pointerdown",this.pt,!1),this.ct.removeEventListener("pointerup",this.Ot,!1),this.ct.removeEventListener("pointermove",this.Et,!1),this.wt.unregisterBeforeRender(this.xt),this.removeAllActionListeners(),this.Vt()},t.prototype.hide=function(){this.C=!0,this.it?(this.O="T",this.disableTranslation()):this.ht?(this.O="R",this.disableRotation()):this.st&&(this.O="S",this.disableScaling()),this.Wt()},t.prototype.Wt=function(){this.$t.visibility=0,this._t.visibility=0,this.ti.visibility=0},t.prototype.ii=function(){this.$t.visibility=this.M,this._t.visibility=this.M,this.ti.visibility=this.M},t.prototype.show=function(){this.C=!1,this.ii(),"T"==this.O?this.enableTranslation():"R"==this.O?this.enableRotation():"S"==this.O&&this.enableScaling()},t.prototype.isHidden=function(){return this.C},t.prototype.Vt=function(){this.At.dispose(),this.hi(),this.Mt=null},t.prototype.addActionListener=function(t){this.g=t},t.prototype.removeActionListener=function(){this.g=null},t.prototype.addActionStartListener=function(t){this.R=t},t.prototype.removeActionStartListener=function(){this.R=null},t.prototype.addActionEndListener=function(t){this.S=t},t.prototype.removeActionEndListener=function(){this.S=null},t.prototype.removeAllActionListeners=function(){this.g=null,this.R=null,this.S=null},t.prototype.Nt=function(t){var i=this;if(t.preventDefault(),this.T=!0,0==t.button){var h=this.wt.pick(this.wt.pointerX,this.wt.pointerY,function(t){if(i.it){if(t==i.si||t==i.ni||t==i.ui||t==i.kt||t==i.Pt||t==i.Qt||t==i.ri)return!0}else if(i.ht){if(t==i.Gt||t==i.Ht||t==i.It||t==i.ei)return!0}else if(i.st&&(t==i.fi||t==i.li||t==i.oi||t==i.jt||t==i.qt||t==i.Dt||t==i.ai))return!0;return!1},null,this.at);if(h.hit){this.ci=h.pickedMesh;var s=this.ci.getChildren();s.length>0?s[0].visibility=this.M:this.ci.visibility=this.M;var n=this.ci.name;"X"==n?this.vi.visibility=1:"Y"==n?this.wi.visibility=1:"Z"==n?this.Mi.visibility=1:"XZ"==n?(this.vi.visibility=1,this.Mi.visibility=1):"ZY"==n?(this.Mi.visibility=1,this.wi.visibility=1):"YX"==n?(this.wi.visibility=1,this.vi.visibility=1):"ALL"==n&&(this.vi.visibility=1,this.wi.visibility=1,this.Mi.visibility=1),this.Yi(!0),this.Xi=this.Zi(this.ci),null!=this.Xi?this.Ai=this.Li():this.Ai=null,window.setTimeout(function(t,h){return i.Bi(t,h)},0,this.at,this.ct)}}},t.prototype.Yi=function(t){this.P=t,t?(this.di(),this.pi==i.ROT&&(this.tt=0),this.Jt(this.pi)):this.Ut(this.pi)},t.prototype.isEditing=function(){return this.P},t.prototype.Bi=function(t,i){var h=i;t.detachControl(h)},t.prototype.isPointerOver=function(){return this.k},t.prototype.Ni=function(){var t=this,i=this.wt.pick(this.wt.pointerX,this.wt.pointerY,function(i){if(t.it){if(i==t.si||i==t.ni||i==t.ui||i==t.kt||i==t.Pt||i==t.Qt||i==t.ri)return!0}else if(t.ht){if(i==t.Gt||i==t.Ht||i==t.It||i==t.ei)return!0}else if(t.st&&(i==t.fi||i==t.li||i==t.oi||i==t.jt||i==t.qt||i==t.Dt||i==t.ai))return!0;return!1},null,this.at);if(i.hit){if(i.pickedMesh!=this.Oi){if(this.k=!0,this.zi(),this.Oi=i.pickedMesh,this.ht)this.Ei=this.Oi.getChildren()[0].color,this.Oi.getChildren()[0].color=n.White();else{var h=this.Oi.getChildren();h.length>0?(this.bi=h[0].material,h[0].material=this.xi):(this.bi=this.Oi.material,this.Oi.material=this.xi)}"X"==this.Oi.name?this.$t.color=n.White():"Y"==this.Oi.name?this._t.color=n.White():"Z"==this.Oi.name&&(this.ti.color=n.White())}}else this.k=!1,null!=this.Oi&&(this.yi(this.Oi),this.Oi=null)},t.prototype.zi=function(){null!=this.Oi&&(this.Oi.visibility=0,this.yi(this.Oi))},t.prototype.yi=function(t){switch(t.name){case"X":this.$t.color=n.Red();break;case"Y":this._t.color=n.Green();break;case"Z":this.ti.color=n.Blue()}if(this.ht)t.getChildren()[0].color=this.Ei;else{var i=t.getChildren();i.length>0?i[0].material=this.bi:t.material=this.bi}},t.prototype.zt=function(t){this.T=!1,this.P&&(this.at.attachControl(this.ct),this.Yi(!1),this.Ci(),null!=this.Oi&&(this.yi(this.Oi),this.Oi=null),this.Mt.add(this.pi))},t.prototype.di=function(){this.it?this.pi=i.TRANS:this.ht?this.pi=i.ROT:this.st&&(this.pi=i.SCALE)},t.prototype.Kt=function(t){null!=this.g&&this.g(t)},t.prototype.Jt=function(t){null!=this.R&&this.R(t)},t.prototype.Ut=function(t){null!=this.S&&this.S(t)},t.prototype.bt=function(t){if(this.T){if(this.P&&null!=this.Ai){var i=this.Li();if(null!=i){if(this.ht)this.gi(this.ot,this.ci,i,this.Ai);else{var h=i.subtract(this.Ai);if(0==h.x&&0==h.y&&0==h.z)return;this.it?this.mi(h):this.st&&this.t&&this.Ri(h)}this.Ai=i,this.Kt(this.pi)}}}else this.Ni()},t.prototype.Zi=function(t){var i=t.name;if(this.it||this.st){if("XZ"==i)return this.Si;if("ZY"==i)return this.Ti;if("YX"==i)return this.ki;if("ALL"==i)return this.Rt;this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L);var h=this.L;if("X"===i)return Math.abs(h.y)>Math.abs(h.z)?this.Si:this.ki;if("Z"===i)return Math.abs(h.y)>Math.abs(h.x)?this.Si:this.Ti;if("Y"===i)return Math.abs(h.z)>Math.abs(h.x)?this.ki:this.Ti}else{if(!this.ht)return null;switch(this.j=!1,this.At.getWorldMatrix().invertToRef(this.A),c.TransformCoordinatesToRef(this.at.position,this.A,this.L),h=this.L,i){case"X":return Math.abs(h.x)<.2?(this.j=!0,this.Rt):this.Ti;case"Y":return Math.abs(h.y)<.2?(this.j=!0,this.Rt):this.Si;case"Z":return Math.abs(h.z)<.2?(this.j=!0,this.Rt):this.ki;default:return this.Rt}}},t.prototype.mi=function(t){null!=this.ot.parent&&this.Ft(this.ot)?this.Zt(this.At):this.Zt(this.ot);var i=this.ci.name;"ALL"==i?this.q=t:(this.q.x=0,this.q.y=0,this.q.z=0,"X"!=i&&"XZ"!=i&&"YX"!=i||(this.t?this.q.x=c.Dot(t,this.J)/this.J.length():this.q.x=t.x),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.t?this.q.y=c.Dot(t,this.K)/this.K.length():this.q.y=t.y),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.t?this.q.z=c.Dot(t,this.U)/this.U.length():this.q.z=t.z)),this.Pi(this.ot,this.q,this.t),this.Qi&&(this.ot.position.x=Math.max(this.ot.position.x,this.Qi.x),this.ot.position.y=Math.max(this.ot.position.y,this.Qi.y),this.ot.position.z=Math.max(this.ot.position.z,this.Qi.z)),this.ji&&(this.ot.position.x=Math.min(this.ot.position.x,this.ji.x),this.ot.position.y=Math.min(this.ot.position.y,this.ji.y),this.ot.position.z=Math.min(this.ot.position.z,this.ji.z)),this.ot.computeWorldMatrix(!0)},t.prototype.Pi=function(t,i,h){if(this.i){var s=!1;if(this.D.addInPlace(i),Math.abs(this.D.x)>this.ut.x&&(this.D.x>0?i.x=this.ut.x:i.x=-this.ut.x,s=!0),Math.abs(this.D.y)>this.ut.y&&(this.D.y>0?i.y=this.ut.y:i.y=-this.ut.y,s=!0),Math.abs(this.D.z)>this.ut.z&&(this.D.z>0?i.z=this.ut.z:i.z=-this.ut.z,s=!0),!s)return;Math.abs(i.x)!==this.ut.x&&(i.x=0),Math.abs(i.y)!==this.ut.y&&(i.y=0),Math.abs(i.z)!==this.ut.z&&(i.z=0),c.FromFloatsToRef(0,0,0,this.D),s=!1}h?(this.J.normalizeToRef(this.rt),this.K.normalizeToRef(this.et),this.U.normalizeToRef(this.ft),this.ot.translate(this.rt,i.x,o.WORLD),this.ot.translate(this.et,i.y,o.WORLD),this.ot.translate(this.ft,i.z,o.WORLD)):null==this.ot.parent?this.ot.position.addInPlace(i):this.ot.setAbsolutePosition(i.addInPlace(this.ot.absolutePosition))},t.prototype.Ri=function(t){this.Zt(this.ot),this.I.x=0,this.I.y=0,this.I.z=0;var i=this.ci.name;"X"!=i&&"XZ"!=i&&"YX"!=i||(this.I.x=c.Dot(t,this.J)/this.J.length(),this.ot.scaling.x<0&&(this.I.x=-this.I.x)),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.I.y=c.Dot(t,this.K)/this.K.length(),this.ot.scaling.y<0&&(this.I.y=-this.I.y)),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.I.z=c.Dot(t,this.U)/this.U.length(),this.ot.scaling.z<0&&(this.I.z=-this.I.z));var h=this.Yt;if(this.I.x=this.I.x/h.x,this.I.y=this.I.y/h.y,this.I.z=this.I.z/h.z,"ALL"==i){var s=c.Dot(t,this.at.upVector);s/=Math.max(h.x,h.y,h.z),this.I.copyFromFloats(s,s,s)}else{var n=!1;"XZ"==i?(n=!0,Math.abs(this.I.x)>Math.abs(this.I.z)?this.I.z=this.I.x:this.I.x=this.I.z):"ZY"==i?(n=!0,Math.abs(this.I.z)>Math.abs(this.I.y)?this.I.y=this.I.z:this.I.z=this.I.y):"YX"==i&&(n=!0,Math.abs(this.I.y)>Math.abs(this.I.x)?this.I.x=this.I.y:this.I.y=this.I.x),n&&(this.At.position.subtractToRef(this.at.position,this.p),s=c.Dot(t,this.p),this.I.x=Math.abs(this.I.x),this.I.y=Math.abs(this.I.y),this.I.z=Math.abs(this.I.z),s>0?(this.ot.scaling.x>0&&(this.I.x=-this.I.x),this.ot.scaling.y>0&&(this.I.y=-this.I.y),this.ot.scaling.z>0&&(this.I.z=-this.I.z)):(this.ot.scaling.x<0&&(this.I.x=-this.I.x),this.ot.scaling.y<0&&(this.I.y=-this.I.y),this.ot.scaling.z<0&&(this.I.z=-this.I.z)))}this.qi(this.ot,this.I),this.Di&&(this.ot.scaling.x=Math.max(this.ot.scaling.x,this.Di.x),this.ot.scaling.y=Math.max(this.ot.scaling.y,this.Di.y),this.ot.scaling.z=Math.max(this.ot.scaling.z,this.Di.z)),this.Fi&&(this.ot.scaling.x=Math.min(this.ot.scaling.x,this.Fi.x),this.ot.scaling.y=Math.min(this.ot.scaling.y,this.Fi.y),this.ot.scaling.z=Math.min(this.ot.scaling.z,this.Fi.z))},t.prototype.qi=function(t,i){if(this.F){var h=!1;if(this.G.addInPlace(i),Math.abs(this.G.x)>this.H&&(i.x>0?i.x=this.H:i.x=-this.H,h=!0),Math.abs(this.G.y)>this.H&&(i.y>0?i.y=this.H:i.y=-this.H,h=!0),Math.abs(this.G.z)>this.H&&(i.z>0?i.z=this.H:i.z=-this.H,h=!0),!h)return;Math.abs(i.x)!==this.H&&0!==i.x&&(i.x=0),Math.abs(i.y)!==this.H&&0!==i.y&&(i.y=0),Math.abs(i.z)!==this.H&&0!==i.z&&(i.z=0),c.FromFloatsToRef(0,0,0,this.G),h=!1}t.scaling.addInPlace(i)},t.prototype.Zt=function(t){var i=t.getWorldMatrix();c.FromFloatArrayToRef(i.m,0,this.J),c.FromFloatArrayToRef(i.m,4,this.K),c.FromFloatArrayToRef(i.m,8,this.U)},t.prototype.Gi=function(){var t=this.At.getWorldMatrix();c.FromFloatArrayToRef(t.m,0,this.V),c.FromFloatArrayToRef(t.m,4,this.W),c.FromFloatArrayToRef(t.m,8,this.$)},t.prototype.Xt=function(t){var i=t.getBoundingInfo().boundingBox,h=i.maximum.subtract(i.minimum);return 0==h.x&&(h.x=1),0==h.y&&(h.y=1),0==h.z&&(h.z=1),h},t.prototype.refreshBoundingInfo=function(){this.Yt=this.Xt(this.ot)},t.prototype.gi=function(t,i,h,n){this.t&&null!=this.ot.parent&&this.Ft(t)?this.Zt(this.At):this.Zt(t);var u,r=0;i==this.Gt?u=this.t?this.J:s.X:i==this.Ht?u=this.t?this.K:s.Y:i==this.It&&(u=this.t?this.U:s.Z),this.At.position.subtractToRef(this.at.position,this.p),this.j?(r=this.Hi(n,h,this.at.position,this.p,u),this.wt.useRightHandedSystem&&(r=-r)):r=this.Ii(n,h,t.getAbsolutePivotPoint(),this.p),this.h&&(this.tt+=r,r=0,Math.abs(this.tt)>=this.u&&(r=this.tt>0?this.u:-this.u,this.tt=0)),0!==r&&(this.p.normalize(),i==this.ei?t.rotate(this.p,-r,o.WORLD):(c.Dot(u,this.p)>=0&&(r=-r),t.rotate(u,r,o.WORLD)),this._&&(t.rotation=t.rotationQuaternion.toEulerAngles(),t.rotationQuaternion=null),this.t&&null!=this.ot.parent&&this.Ft(t)&&(i==this.ei?this.At.rotate(this.p,-r,o.WORLD):this.At.rotate(u,r,o.WORLD)))},t.prototype.Li=function(){var t=this,i=this.wt.pick(this.wt.pointerX,this.wt.pointerY,function(i){return i==t.Xi},null,this.at);return i.hit?i.pickedPoint:null},t.prototype.Ci=function(){this.vi.visibility=0,this.wi.visibility=0,this.Mi.visibility=0},t.prototype.Ji=function(t){this.it&&(this.Ki.visibility=t,this.Ui.visibility=t,this.Vi.visibility=t,this.Wi.visibility=t,this.$i.visibility=t,this._i.visibility=t,this.th.visibility=t),this.ht&&(this.ih.visibility=t,this.hh.visibility=t,this.sh.visibility=t,this.nh.visibility=t),this.st&&(this.uh.visibility=t,this.rh.visibility=t,this.eh.visibility=t,this.fh.visibility=t,this.lh.visibility=t,this.oh.visibility=t,this.ah.visibility=t)},t.prototype.getRotationQuaternion=function(){return this.At.rotationQuaternion},t.prototype.getPosition=function(){return this.At.position},t.prototype.isTranslationEnabled=function(){return this.it},t.prototype.enableTranslation=function(){null==this.si&&(this.vh(),this.wh.parent=this.At),this.zi(),this.it||(this.Ki.visibility=this.M,this.Ui.visibility=this.M,this.Vi.visibility=this.M,this.Wi.visibility=this.M,this.$i.visibility=this.M,this._i.visibility=this.M,this.th.visibility=this.M,this.it=!0,this.disableRotation(),this.disableScaling())},t.prototype.disableTranslation=function(){this.it&&(this.Ki.visibility=0,this.Ui.visibility=0,this.Vi.visibility=0,this.Wi.visibility=0,this.$i.visibility=0,this._i.visibility=0,this.th.visibility=0,this.it=!1)},t.prototype.isRotationEnabled=function(){return this.ht},t.prototype.returnEuler=function(t){this._=t},t.prototype.enableRotation=function(){null==this.Mh&&(this.Yh(),this.Mh.parent=this.At),this.zi(),this.ht||(this.ih.visibility=this.M,this.hh.visibility=this.M,this.sh.visibility=this.M,this.nh.visibility=this.M,this.Xh.visibility=this.M,this.ht=!0,this.disableTranslation(),this.disableScaling())},t.prototype.disableRotation=function(){this.ht&&(this.ih.visibility=0,this.hh.visibility=0,this.sh.visibility=0,this.nh.visibility=0,this.Xh.visibility=0,this.ht=!1)},t.prototype.isScalingEnabled=function(){return this.st},t.prototype.enableScaling=function(){null==this.fi&&(this.Zh(),this.Ah.parent=this.At),this.zi(),this.st||(this.uh.visibility=this.M,this.rh.visibility=this.M,this.eh.visibility=this.M,this.fh.visibility=this.M,this.lh.visibility=this.M,this.oh.visibility=this.M,this.ah.visibility=this.M,this.st=!0,this.disableTranslation(),this.disableRotation())},t.prototype.disableScaling=function(){this.st&&(this.uh.visibility=0,this.rh.visibility=0,this.eh.visibility=0,this.fh.visibility=0,this.lh.visibility=0,this.oh.visibility=0,this.ah.visibility=0,this.st=!1)},t.prototype.setScaleBounds=function(t,i){this.Di=t||null,this.Fi=i||null,null!=this.Di&&(0==this.Di.x&&(this.Di.x=1e-8),0==this.Di.y&&(this.Di.y=1e-8),0==this.Di.z&&(this.Di.z=1e-8))},t.prototype.removeScaleBounds=function(){this.Di=null,this.Fi=null},t.prototype.setTransBounds=function(t,i){this.Qi=t||null,this.ji=i||null},t.prototype.removeTransBounds=function(){this.Qi=null,this.ji=null},t.prototype.setRotBounds=function(t,i){this.Lh=t||null,this.Bh=i||null},t.prototype.removeRotBounds=function(){this.Lh=null,this.Bh=null},t.prototype.Bt=function(){var t=new r("guideCtl",this.wt);this.vi=r.CreateLines("bxAxis",[new c(-100,0,0),new c(100,0,0)],this.wt),this.wi=r.CreateLines("byAxis",[new c(0,-100,0),new c(0,100,0)],this.wt),this.Mi=r.CreateLines("bzAxis",[new c(0,0,-100),new c(0,0,100)],this.wt),this.vi.isPickable=!1,this.wi.isPickable=!1,this.Mi.isPickable=!1,this.vi.parent=t,this.wi.parent=t,this.Mi.parent=t,this.vi.color=n.Red(),this.wi.color=n.Green(),this.Mi.color=n.Blue(),this.Ci();var i=this.l*this.o*.75;return this.$t=r.CreateLines("xAxis",[new c(0,0,0),new c(i,0,0)],this.wt),this._t=r.CreateLines("yAxis",[new c(0,0,0),new c(0,i,0)],this.wt),this.ti=r.CreateLines("zAxis",[new c(0,0,0),new c(0,0,i)],this.wt),this.$t.isPickable=!1,this._t.isPickable=!1,this.ti.isPickable=!1,this.$t.parent=t,this._t.parent=t,this.ti.parent=t,this.$t.color=n.Red(),this._t.color=n.Green(),this.ti.color=n.Blue(),this.$t.renderingGroupId=1,this._t.renderingGroupId=1,this.ti.renderingGroupId=1,t},t.prototype.dt=function(){this.Rt=r.CreatePlane("pALL",5,this.wt),this.Si=r.CreatePlane("pXZ",5,this.wt),this.Ti=r.CreatePlane("pZY",5,this.wt),this.ki=r.CreatePlane("pYX",5,this.wt),this.Rt.isPickable=!1,this.Si.isPickable=!1,this.Ti.isPickable=!1,this.ki.isPickable=!1,this.Rt.visibility=0,this.Si.visibility=0,this.Ti.visibility=0,this.ki.visibility=0,this.Rt.renderingGroupId=1,this.Si.renderingGroupId=1,this.Ti.renderingGroupId=1,this.ki.renderingGroupId=1,this.Rt.lookAt(this.at.position),this.Si.rotate(s.X,1.57),this.Ti.rotate(s.Y,1.57);var t=new r("pickPlanes",this.wt);return this.Rt.parent=t,this.Si.parent=t,this.Ti.parent=t,this.ki.parent=t,t},t.prototype.vh=function(){var t=2*this.v*this.o,i=this.l*this.o;this.wh=new r("tarnsCtl",this.wt),this.si=this.dh(t/2,i),this.si.name="X",this.ni=this.si.clone("Y"),this.ui=this.si.clone("Z"),this.kt=e.CreatePlane("XZ",{size:2*t},this.wt),this.Pt=e.CreatePlane("ZY",{size:2*t},this.wt),this.Qt=e.CreatePlane("YX",{size:2*t},this.wt),this.kt.rotation.x=1.57,this.Pt.rotation.y=-1.57,this.kt.position.x=t,this.kt.position.z=t,this.Pt.position.z=t,this.Pt.position.y=t,this.Qt.position.y=t,this.Qt.position.x=t,this.kt.bakeCurrentTransformIntoVertices(),this.Pt.bakeCurrentTransformIntoVertices(),this.Qt.bakeCurrentTransformIntoVertices(),this.ri=r.CreateBox("ALL",2*t,this.wt),this.si.parent=this.wh,this.ni.parent=this.wh,this.ui.parent=this.wh,this.kt.parent=this.wh,this.Pt.parent=this.wh,this.Qt.parent=this.wh,this.ri.parent=this.wh,this.si.rotation.y=1.57,this.ni.rotation.x-=1.57,this.si.visibility=0,this.ni.visibility=0,this.ui.visibility=0,this.kt.visibility=0,this.Pt.visibility=0,this.Qt.visibility=0,this.ri.visibility=0,this.si.isPickable=!1,this.ni.isPickable=!1,this.ui.isPickable=!1,this.kt.isPickable=!1,this.Pt.isPickable=!1,this.Qt.isPickable=!1,this.ri.isPickable=!1;var h=i/5,s=t;this.Ki=r.CreateCylinder("tEndX",h,0,s,6,1,this.wt),this.Ui=this.Ki.clone("tEndY"),this.Vi=this.Ki.clone("tEndZ"),this.Wi=this.ph("XZ",1.75*s,this.wt),this.$i=this.Wi.clone("ZY"),this._i=this.Wi.clone("YX"),this.th=e.CreatePolyhedron("tEndAll",{type:1,size:s/2},this.wt),this.Ki.rotation.x=1.57,this.Ui.rotation.x=1.57,this.Vi.rotation.x=1.57,this.$i.rotation.z=1.57,this._i.rotation.x=-1.57,this.Wi.position.x=t,this.Wi.position.z=t,this.$i.position.z=t,this.$i.position.y=t,this._i.position.y=t,this._i.position.x=t,this.Ki.parent=this.si,this.Ui.parent=this.ni,this.Vi.parent=this.ui,this.Wi.parent=this.kt,this.$i.parent=this.Pt,this._i.parent=this.Qt,this.th.parent=this.ri,this.Ki.position.z=i-h/2,this.Ui.position.z=i-h/2,this.Vi.position.z=i-h/2,this.Ki.material=this.Nh,this.Ui.material=this.Oh,this.Vi.material=this.zh,this.Wi.material=this.Oh,this.$i.material=this.Nh,this._i.material=this.zh,this.th.material=this.Eh,this.Ki.renderingGroupId=2,this.Ui.renderingGroupId=2,this.Vi.renderingGroupId=2,this.Wi.renderingGroupId=2,this.$i.renderingGroupId=2,this._i.renderingGroupId=2,this.th.renderingGroupId=2,this.Ki.isPickable=!1,this.Ui.isPickable=!1,this.Vi.isPickable=!1,this.Wi.isPickable=!1,this.$i.isPickable=!1,this._i.isPickable=!1,this.th.isPickable=!1},t.prototype.ph=function(t,i,h){var s=new f(i/2,-i/2).addLineTo(i/2,i/2).addLineTo(-i/2,i/2).addLineTo(i/2,-i/2);return new BABYLON.PolygonMeshBuilder(t,s,h).build()},t.prototype.setRotGuideFull=function(t){this.nt=t?360:180,null!=this.Mh&&(this.Mh.dispose(),this.ei.dispose(),this.Mh=null,this.enableRotation())},t.prototype.Yh=function(){var t=this.l*this.o*2;this.Mh=new r("rotCtl",this.wt),this.Gt=this.bh(t/2,this.nt),this.Gt.name="X",this.Ht=this.bh(t/2,this.nt),this.Ht.name="Y",this.It=this.bh(t/2,this.nt),this.It.name="Z",this.ei=this.bh(t/1.75,360),this.ei.name="ALL",this.Gt.rotation.z=1.57,this.It.rotation.x=-1.57,this.Gt.bakeCurrentTransformIntoVertices(),this.It.bakeCurrentTransformIntoVertices(),this.ei.rotation.x=1.57,this.Gt.parent=this.Mh,this.Ht.parent=this.Mh,this.It.parent=this.Mh,this.ei.parent=this.Rt,this.Gt.visibility=0,this.Ht.visibility=0,this.It.visibility=0,this.ei.visibility=0,this.Gt.isPickable=!1,this.Ht.isPickable=!1,this.It.isPickable=!1,this.ei.isPickable=!1;var i=t;this.ih=this.xh(i/2,this.nt,!1),this.hh=this.ih.clone(""),this.sh=this.ih.clone(""),this.nh=this.xh(i/1.75,360,!1),this.Xh=this.xh(i/2,360,!1),this.ih.parent=this.Gt,this.hh.parent=this.Ht,this.sh.parent=this.It,this.ih.rotation.z=1.57,this.sh.rotation.x=-1.57,this.nh.parent=this.ei,this.Xh.parent=this.ei,this.ih.color=n.Red(),this.hh.color=n.Green(),this.sh.color=n.Blue(),this.nh.color=n.Yellow(),this.Xh.color=n.Gray(),this.ih.renderingGroupId=2,this.hh.renderingGroupId=2,this.sh.renderingGroupId=2,this.nh.renderingGroupId=2,this.Xh.renderingGroupId=2,this.ih.isPickable=!1,this.hh.isPickable=!1,this.sh.isPickable=!1,this.nh.isPickable=!1,this.Xh.isPickable=!1},t.prototype.dh=function(t,i){var h=[new c(t,t,0),new c(-t,t,0),new c(-t,-t,0),new c(t,-t,0),new c(t,t,0)],s=[new c(0,0,0),new c(0,0,i)];return r.ExtrudeShape("",h,s,1,0,2,this.wt)},t.prototype.xh=function(t,i,h){null===i&&(i=360);for(var s,n,u=[],e=3.14/180,f=0,l=0;l<=i;l+=5)s=t*Math.cos(l*e),n=90==l?t:270==l?-t:t*Math.sin(l*e),u[f]=new c(s,0,n),f++;if(h)for(t-=.04,l=0;l<=i;l+=5)s=t*Math.cos(l*e),n=90==l?t:270==l?-t:t*Math.sin(l*e),u[f]=new c(s,0,n),f++;return r.CreateLines("",u,this.wt)},t.prototype.bh=function(t,i){null===i&&(i=360);for(var h,s,n=[],u=0,e=0;e<=i;e+=30)h=t*Math.cos(e*(3.14/180)),s=90==e?t:270==e?-t:t*Math.sin(e*(3.14/180)),n[u]=new c(h,0,s),u++;return r.CreateTube("",n,this.v*this.o*2,3,null,BABYLON.Mesh.yh,this.wt)},t.prototype.Zh=function(){var t=2*this.v*this.o,i=this.l*this.o;this.Ah=new r("sCtl",this.wt),this.fi=this.dh(t/2,i),this.fi.name="X",this.li=this.fi.clone("Y"),this.oi=this.fi.clone("Z"),this.jt=e.CreatePlane("XZ",{size:2*t},this.wt),this.qt=e.CreatePlane("ZY",{size:2*t},this.wt),this.Dt=e.CreatePlane("YX",{size:2*t},this.wt),this.jt.rotation.x=1.57,this.qt.rotation.y=-1.57,this.jt.position.x=t,this.jt.position.z=t,this.qt.position.z=t,this.qt.position.y=t,this.Dt.position.y=t,this.Dt.position.x=t,this.jt.bakeCurrentTransformIntoVertices(),this.qt.bakeCurrentTransformIntoVertices(),this.Dt.bakeCurrentTransformIntoVertices(),this.ai=r.CreateBox("ALL",2*t,this.wt),this.fi.parent=this.Ah,this.li.parent=this.Ah,this.oi.parent=this.Ah,this.ai.parent=this.Ah,this.jt.parent=this.Ah,this.qt.parent=this.Ah,this.Dt.parent=this.Ah,this.fi.rotation.y=1.57,this.li.rotation.x-=1.57,this.fi.visibility=0,this.li.visibility=0,this.oi.visibility=0,this.jt.visibility=0,this.qt.visibility=0,this.Dt.visibility=0,this.ai.visibility=0,this.fi.isPickable=!1,this.li.isPickable=!1,this.oi.isPickable=!1,this.jt.isPickable=!1,this.qt.isPickable=!1,this.Dt.isPickable=!1,this.ai.isPickable=!1;var h=t;this.uh=r.CreateBox("",h,this.wt),this.rh=this.uh.clone(""),this.eh=this.uh.clone(""),this.fh=this.ph("XZ",1.75*h,this.wt),this.lh=this.fh.clone("ZY"),this.oh=this.fh.clone("YX"),this.ah=e.CreatePolyhedron("sEndAll",{type:1,size:h/2},this.wt),this.lh.rotation.z=1.57,this.oh.rotation.x=-1.57,this.fh.position.x=t,this.fh.position.z=t,this.lh.position.z=t,this.lh.position.y=t,this.oh.position.y=t,this.oh.position.x=t,this.uh.parent=this.fi,this.rh.parent=this.li,this.eh.parent=this.oi,this.fh.parent=this.jt,this.lh.parent=this.qt,this.oh.parent=this.Dt,this.ah.parent=this.ai,this.uh.position.z=i-h/2,this.rh.position.z=i-h/2,this.eh.position.z=i-h/2,this.uh.material=this.Nh,this.rh.material=this.Oh,this.eh.material=this.zh,this.fh.material=this.Oh,this.lh.material=this.Nh,this.oh.material=this.zh,this.ah.material=this.Eh,this.uh.renderingGroupId=2,this.rh.renderingGroupId=2,this.eh.renderingGroupId=2,this.fh.renderingGroupId=2,this.lh.renderingGroupId=2,this.oh.renderingGroupId=2,this.ah.renderingGroupId=2,this.uh.isPickable=!1,this.rh.isPickable=!1,this.eh.isPickable=!1,this.fh.isPickable=!1,this.lh.isPickable=!1,this.oh.isPickable=!1,this.ah.isPickable=!1},t.prototype.Ch=function(t){var i=c.Cross(this.J,this.K);return c.Dot(i,this.U)<0},t.prototype.setVisibility=function(t){this.M=t},t.prototype.setLocal=function(t){this.t!=t&&(this.t=t,t||(this.At.rotationQuaternion=l.Identity()))},t.prototype.isLocal=function(){return this.t},t.prototype.setTransSnap=function(t){this.i=t},t.prototype.setRotSnap=function(t){this.h=t},t.prototype.setScaleSnap=function(t){this.F=t},t.prototype.setTransSnapValue=function(t){this.ut.copyFromFloats(t,t,t),this.s=t},t.prototype.setRotSnapValue=function(t){this.u=t},t.prototype.setScaleSnapValue=function(t){this.H=t},t.prototype.Hi=function(t,i,h,s,n){var u=c.Dot(s,n);n.scaleToRef(u,this.rt),h.addToRef(this.rt,this.et);var r=this.et;this.at.getWorldMatrix().invertToRef(this.lt),c.TransformCoordinatesToRef(this.et,this.lt,this.et);var e=0;r.x>=0&&r.y>=0?e=1:r.x<=0&&r.y>=0?e=2:r.x<=0&&r.y<=0?e=3:r.x>=0&&r.y<=0&&(e=4),c.TransformCoordinatesToRef(t,this.lt,this.rt),c.TransformCoordinatesToRef(i,this.lt,this.et),this.et.subtractInPlace(this.rt);var f=this.et,l=f.length(),o="";f.x>=0&&f.y>=0?o=f.x>=f.y?"r":"u":f.x<=0&&f.y>=0?o=-f.x>=f.y?"l":"u":f.x<=0&&f.y<=0?o=-f.x>=-f.y?"l":"d":f.x>=0&&f.y<=0&&(o=f.x>=-f.y?"r":"d");var a=0;return"d"==o?a=1==e||4==e?1:-1:"u"==o?a=1==e||4==e?-1:1:"r"==o?a=2==e||1==e?1:-1:"l"==o&&(a=2==e||1==e?-1:1),a*l},t.prototype.Ii=function(t,i,h,s){t.subtractToRef(h,this.rt),i.subtractToRef(h,this.et),c.CrossToRef(this.rt,this.et,this.ft);var n=Math.asin(this.ft.length()/(this.rt.length()*this.et.length()));return c.Dot(this.ft,s)>0&&(n*=-1),n},t.prototype.Lt=function(i){this.Nh=t.gh("redMat",n.Red(),i),this.Oh=t.gh("greenMat",n.Green(),i),this.zh=t.gh("blueMat",n.Blue(),i),this.xi=t.gh("whiteMat",n.White(),i),this.Eh=t.gh("whiteMat",n.Yellow(),i)},t.prototype.hi=function(){this.Nh.dispose(),this.Oh.dispose(),this.zh.dispose(),this.xi.dispose(),this.Eh.dispose()},t.gh=function(t,i,h){var s=new a(t,h);return s.emissiveColor=i,s.diffuseColor=n.Black(),s.specularColor=n.Black(),s.backFaceCulling=!1,s},t}();t.EditControl=v;var w=function(){function t(t,i){this.lastMax=10,this.acts=new Array,this.last=-1,this.current=-1,this.mesh=t,this.lastMax=i-1,this.add()}return t.prototype.setCapacity=function(t){0!=t?(this.lastMax=t-1,this.last=-1,this.current=-1,this.acts=new Array,this.add()):console.error("capacity should be more than zero")},t.prototype.add=function(t){void 0===t&&(t=null);var i=new M(this.mesh,t);this.current<this.last&&(this.acts.splice(this.current+1),this.last=this.current),this.last==this.lastMax?(this.acts.shift(),this.acts.push(i)):(this.acts.push(i),this.last++,this.current++)},t.prototype.undo=function(){if(this.current>0){var t=this.acts[this.current].getActionType();return this.current--,this.acts[this.current].perform(this.mesh),t}},t.prototype.redo=function(){if(this.current<this.last)return this.current++,this.acts[this.current].perform(this.mesh),this.acts[this.current].getActionType()},t}();t.ActHist=w;var M=function(){function t(t,i){this.mh=t.position.clone(),null==t.rotationQuaternion?(this.Rh=null,this.Sh=t.rotation.clone()):(this.Rh=t.rotationQuaternion.clone(),this.Sh=null),this.Th=t.scaling.clone(),this.kh=i}return t.prototype.getActionType=function(){return this.kh},t.prototype.perform=function(t){t.position.copyFrom(this.mh),null==t.rotationQuaternion?null!=this.Sh?t.rotation.copyFrom(this.Sh):t.rotation.copyFrom(this.Rh.toEulerAngles()):null!=this.Rh?t.rotationQuaternion.copyFrom(this.Rh):t.rotationQuaternion.copyFrom(l.RotationYawPitchRoll(this.Sh.y,this.Sh.x,this.Sh.z)),t.scaling.copyFrom(this.Th)},t}();t.Act=M}((h=i.babylonjs||(i.babylonjs={})).component||(h.component={}))}(org||(org={}));